function CashierPageLoad(){null==localStorage.getItem("order-table")?($(".order").addClass("hidden"),$("#js-item--search").val("").focus()):(OrderTotalSum(),OrderButtonActive($(".js-order--type").eq(localStorage["order-type-index"])),OrderButtonActive($(".js-order--discount").eq(localStorage["order-discount-index"])),$(".order-table").removeClass("hidden").html(localStorage.getItem("order-table")))}function OrderClear(){localStorage.clear(),$(".order-table table tbody").html(""),$(".js-order--type").removeClass("active"),CashierPageLoad()}function OrderItemAdd(t){var e,a;null==localStorage.getItem("items")?(e={},a=[],e.items=a,e.items.push(t),e.totalSum=t.price*t.quantity,e.discount=!1,localStorage.setItem("items",JSON.stringify(e))):(e=JSON.parse(localStorage.getItem("items")),e.items.push(t),localStorage.setItem("items",JSON.stringify(e))),OrderTotalSum()}function OrderUpdate(t){var e,a,s,r,n;e=t.parents("tr"),a=e.data("item"),s=t.attr("placeholder"),value=Number(t.val()),0==value.length&&(s.length>0?t.val(s):t.val(1)),0==value&&t.val(1),t.parent("td").hasClass("js-order--update-price")&&(r=value,n=Number(e.find(".js-order--update-quantity").text())),t.parent("td").hasClass("js-order--update-quantity")&&(r=Number(e.find(".js-order--update-price").text()),n=value),OrderItemUpdate(t,a,r,n)}function OrderTotalSum(){json=JSON.parse(localStorage.getItem("items")),totalSum=json.items.reduce(function(t,e){return t+e.sum},0),json.totalSum=totalSum,localStorage.setItem("items",JSON.stringify(json)),$("#order-sum").html(totalSum)}function OrderItemUpdate(t,e,a,s){var r,n,o;r=JSON.parse(localStorage.getItem("items")),max_qty=r.items[e].stock,qty=s<=max_qty?s:max_qty,n=a*qty,r.items[e].price=a,r.items[e].quantity=qty,r.items[e].sum=n,localStorage.setItem("items",JSON.stringify(r)),OrderTotalSum(),o=$('*[data-item="'+e+'"]'),o.find(".js-order--sum").html(n),localStorage.setItem("order-table",$(".order-table").html()),t&&t.parent("td").hasClass("js-order--update-price")&&t.parent("td").html(a),t&&t.parent("td").hasClass("js-order--update-quantity")&&t.parent("td").html(qty)}function OrderItemPaste(t){var e,a,s;a=$(".order-table tbody tr").length,e+='<tr data-item="'+a+'" data-id="'+t.id+'">',e+="<td>"+t.barcode+"</td>",e+="<td>"+t.name+"</td>",e+='<td class="js-order--update js-order--update-price">'+t.price+"</td>",e+='<td class="js-order--update js-order--update-quantity">1</td>',e+='<td class="js-order--sum">'+t.price+"</td>",e+='<td><button type="button" class="btn btn-xs btn-danger js-order--remove"><i class="fa fa-remove"></i></button></td>',e+="</tr>",s={id:t.id,item:a,barcode:t.barcode,price:Number(t.price),quantity:1,sum:Number(t.price),stock:Number(t.stock)},OrderItemAdd(s),$(".order-table table tbody").append(e),localStorage.setItem("order-table",$(".order-table").html()),CashierPageLoad()}function removeDuplicates(t,e){var a=[],s={};for(var r in t)s[t[r][e]]=t[r];for(r in s)a.push(s[r]);return a}function functiontofindIndexByKeyValue(t,e,a){for(var s=0;s<t.length;s++)if(t[s][e]==a)return s;return"z"}function OrderButtonActive(t){var e=t.siblings();e.each(function(){$(this).removeClass("active")}),t.addClass("active")}function LoaderStart(){$("body").append('<div class="loader"></div>')}function LoaderStop(){$(".loader").remove()}function AnswerSuccess(t){$("#js-modal--create").modal("hide"),$("#alert").removeClass().addClass("alert alert-success").html(t)}function AnswerError(){$("#js-modal--create").modal("hide"),$("#alert").removeClass().addClass("alert alert-danger").html("Ошибка запроса")}function AnswerInfo(t){$("#js-modal--create").modal("hide"),$("#js-modal--delete").modal("hide"),$("#alert").removeClass().addClass("alert alert-info").html(t)}function AnswerWarning(t){$("#js-modal--create").modal("hide"),$("#alert").removeClass().addClass("alert alert-warning").html(t)}function number_format(t,e,a,s){var r,n,o,d,l;return isNaN(e=Math.abs(e))&&(e=2),void 0==a&&(a=","),void 0==s&&(s="."),r=parseInt(t=(+t||0).toFixed(e))+"",(n=r.length)>3?n%=3:n=0,l=n?r.substr(0,n)+s:"",o=r.substr(n).replace(/(\d{3})(?=\d)/g,"$1"+s),d=e?a+Math.abs(t-r).toFixed(e).replace(/-/,0).slice(2):"",l+o+d}$(".modal").modal({backdrop:"static",keyboard:!1,show:!1}),$(document).ready(function(){function t(t){$.each(t,function(t,e){switch(e){case"update":$(".table tbody tr td[data-column]").each(function(){$(this).addClass("js--update")});break;case"delete":html='<td class="col-md-1"><button class="btn btn-danger btn-circle js--delete"><i class="fa fa-remove"></i></button></td>',$(".table tbody tr").each(function(){$(this).append(html)});break;case"status":$(".table tbody tr td button[data-status]").each(function(){$(this).addClass("js-items--status")})}})}function e(t){var e=[];checkOption=[],$("ul.nav.navbar-nav.navbar-right li.js--url-user-links").each(function(){var t=$(this).attr("id").substring(8);checkOption.push(t)}),checkOption.length>0?(Array.prototype.diff=function(t){return this.filter(function(e){return t.indexOf(e)<0})},e=t.diff(checkOption)):e=t,$.each(e,function(t,e){switch(e){case"create":$("ul.navbar-right").prepend('<li class="js--url-user-links" id="js--url-create"><a href="'+segment2+'/create">создать</a></li>');break;case"create-modal":$("ul.navbar-right").prepend('<li class="js--url-user-links" id="js--url-create-modal"><a href="#" data-toggle="modal" data-target="#js-modal--create">создать</a></li>');break;case"date-range":html='<li class="dropdown js--url-user-links" id="js--url-date-range">',html+='<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">',html+='настройки <span class="caret"></span>',html+="</a>",html+='<ul class="dropdown-menu dropdown-menu--lg" role="menu">',html+='<li class="dropdown-header">Выбрать период</li>',html+="<li>",html+='<div class="col-md-12">',html+='<form url="'+segment1+"/"+segment2+'/date" method="post" id="js-date_range--form">',html+='<div class="form-group col-md-push-1">',html+='<div class="input-group date datetimepicker">',html+='<input type="text" name="date_start" class="form-control input-sm" placeholder="Дата начала">',html+='<span class="input-group-addon">',html+='<span class="glyphicon glyphicon-calendar"></span>',html+="</span>",html+="</div>",html+="</div>",html+='<div class="form-group col-md-push-1">',html+='<div class="input-group date datetimepicker">',html+='<input type="text" name="date_end" class="form-control input-sm" placeholder="Дата конца">',html+='<span class="input-group-addon">',html+='<span class="glyphicon glyphicon-calendar"></span>',html+="</span>",html+="</div>",html+="</div>",html+='<button type="button" class="btn btn-primary btn-sm" id="js-date_range--sbm">Показать</button>',html+="</form>",html+="</div>",html+="</li>",html+='<li class="divider"></li>',html+="</ul>",html+="</li>",$("ul.navbar-right").prepend(html)}})}function a(){switch(parseInt(userOptions.status)){case 1:switch(segment2){case"orders":0==segment3.length&&e(["date-range","create"]);break;default:return!1}break;case 2:switch(segment2){case"orders":0==segment3.length&&e(["date-range"]);break;case"supply":0==segment3.length&&e(["date-range"]);break;case"costs":0==segment3.length&&e(["date-range"]);break;default:return!1}break;case 3:switch(segment2){case"items":e(["create-modal"]),t(["update","status"]);break;case"orders":0==segment3.length&&e(["date-range"]),t(["delete"]);break;case"supply":0==segment3.length&&e(["date-range","create"]),t(["update","delete"]);break;case"costs":segment3.length>0&&e(["date-range","create-modal"]),t(["update","delete"])}break;case 4:switch(segment2){case"items":e(["create-modal"]),t(["update","status"]);break;case"orders":0==segment3.length&&e(["date-range"]),t(["delete"]);break;case"supply":0==segment3.length&&e(["date-range","create"]),t(["update","delete"]);break;case"costs":segment3.length>0&&e(["date-range","create-modal"]),t(["update","delete"])}break;default:return!1}}function s(t){var e,a=0,s=0;$("strong").hasClass("totalSum")&&(t&&(e=$(".table tbody").find("[data-id='"+t.id+"']"),$(e).find("td.js--totalSum").html(number_format(t.sum,0," "," "))),$("td.js--totalSum").each(function(){a+=parseFloat($(this).text().replace(/\s/g,""))}),$(".totalSum").html("Итого "+number_format(a,0," "," ")+" &#8381;")),$("strong").hasClass("totalSumDiscount")&&($(".js--sum-discount").each(function(){s+=parseFloat($(this).text().replace(/\s/g,""))}),$(".totalSumDiscount").html("Итого со скидкой "+number_format(s,0," "," ")+" &#8381;"))}function r(t){var e,a,r,n;switch(e=JSON.parse(t.responseText),t.status){case 422:a=Object.keys(e),$("form input").each(function(){r=$(this),a.indexOf(r.attr("name"))!=-1?r.addClass("validate-error"):r.addClass("validate-success")});break;case 200:switch(segment2){case"items":e.data.price=number_format(e.data.price,0," "," "),html='<tr data-id="'+e.data.id+'">',html+="<td>"+e.data.barcode+"</td>",html+="<td>"+e.data.name+"</td>",html+='<td class="js--update" data-column="price">'+e.data.price+"</td>",html+='<td><button class="btn btn-circle btn-success js-items--status" data-status="'+e.data.status+'"><i class="fa fa-check"></i></button></td>',html+='<td><button type="button" data-barcode="'+e.data.barcode+'" class="btn btn-circle btn-primary js-items--print-review"><i class="fa fa-print"></i></button></td>',html+="</tr>",$(".table tbody").prepend(html);break;case"costs":n=e.data,n.date=moment(e.data.created_at,"YYYY-MM-DD HH:mm:ss").format("DD/MM/YYYY"),n.sum=number_format(e.data.sum,0," "," "),html='<tr data-id="'+n.id+'">',html+='<td class="col-md-1">'+n.id+"</td>",html+='<td class="col-md-1">'+n.date+"</td>",html+='<td class="col-md-9 js--totalSum js--update" data-column="sum">'+n.sum+"</td>",html+='<td class="col-md-1"><button class="btn btn-circle btn-danger js--delete"><li class="fa fa-remove"></li></button></td>',html+="</tr>",$(".table tbody").prepend(html);break;case"discounts":e.data.sum=number_format(e.data.sum,0," "," "),html='<tr data-id="'+e.data.id+'">',html+='<td class="col-md-1">'+e.data.id+"</td>",html+='<td class="col-md-5 js--update" data-column="sum">'+e.data.sum+"</td>",html+='<td class="col-md-5 js--update" data-column="percent">'+e.data.percent+"</td>",html+='<td class="col-md-1"><button class="btn btn-danger btn-circle js--delete"><i class="fa fa-remove"></i></button></td>',html+="</tr>",$(".table tbody").prepend(html)}AnswerInfo(e.message),s();break;default:AnswerError()}LoaderStop()}function n(t,e){var a=JSON.parse(t.responseText);switch(t.status){case 422:e.parent("td").html(e.attr("placeholder")),$(".table tbody tr").removeClass(),e.parents("tr").addClass("warning"),AnswerWarning(a.message.value);break;case 200:val=number_format(e.val(),0," "," "),e.parent("td").html(val),$(".table tbody tr").removeClass(),e.parents("tr").addClass("info"),s(a.data),AnswerInfo(a.message)}LoaderStop()}function o(t,e){var a=JSON.parse(t.responseText);switch(t.status){case 422:AnswerError();break;case 301:window.location.href=base_url+"/"+segment1+"/"+segment2;break;case 200:AnswerInfo(a.message),e.remove(),s();break;case 404:break;default:AnswerError()}LoaderStop()}function d(t){var t,e,a,s,r;0==t.val()||0==t.val().length?t.parent("td").html(t.attr("placeholder")):(a=t.parents("tr"),e=a.data("id"),s=t.parent("td").data("column"),type=a.parents("tbody").data("type"),r={column:s,value:t.val(),type:type},$.ajax({url:base_url+"/"+segment1+"/"+segment2+"/"+e,type:"patch",dataType:"json",data:r,beforeSend:function(){LoaderStart()},complete:function(e,a,s){n(e,t)}}))}"undefined"!=typeof userOptions&&a(),$(".datetimepicker").datetimepicker({locale:"ru",format:"DD/MM/YYYY"}),$("#js-date_range--sbm").click(function(t){t.preventDefault();var e,s,r;e=$("#js-date_range--form").serializeArray(),e.push({name:"id",value:segment3}),$.ajax({url:base_url+"/"+segment1+"/"+segment2+"/date",type:"patch",dataType:"json",data:e,beforeSend:function(){$(".dropdown").removeClass("open"),LoaderStart()},success:function(t){if($(".col-body h2").remove(),0==t.status&&($(".table").addClass("hidden"),$(".col-footer").addClass("hidden"),$(".col-body").append("<h2>"+t.data+"</h2>")),1==t.status){switch(s="",r=JSON.stringify(t.data),e=JSON.parse(r),$(".table").removeClass("hidden"),$(".col-footer").removeClass("hidden"),segment2){case"costs":for(row in e)s+='<tr data-id="'+e[row].id+'">',s+='<td class="col-md-1">'+e[row].id+"</td>",s+='<td class="col-md-1">'+e[row].date+"</td>",s+='<td class="col-md-9 js--totalSum" data-column="sum">'+e[row].sum+"</td>",s+="</tr>";break;case"supply":for(row in e)s+='<tr data-id="'+e[row].id+'">',s+='<td class="col-md-2 js--url-link" data-url="'+segment2+"/"+e[row].id+'">'+e[row].id+"</td>",s+='<td class="col-md-1">'+e[row].date+"</td>",s+='<td class="col-md-3 js--totalSum data-column="sum">'+e[row].sum+"</td>",s+="</tr>";break;case"orders":for(row in e)s+='<tr data-id="'+e[row].id+'">',s+='<td class="col-md-2 js--url-link" data-url="'+segment2+"/"+e[row].id+'">'+e[row].id+"</td>",s+='<td class="col-md-1">'+e[row].date+"</td>",s+='<td class="col-md-3 js--totalSum">'+e[row].sum+"</td>",s+='<td class="col-md-3">'+e[row].sum_discount+"</td>",s+='<td class="col-md-2">'+e[row].type+"</td>",s+="</tr>";break;default:return!1}$(".table tbody").html(s),$(".totalSum").html("Итого: "+t.extra.totalSum+" &#8381;")}},error:function(t){AnswerError()}}).complete(function(){a(),LoaderStop()})}),$("body").on("click",".js--url-link",function(t){t.preventDefault();var e=$(this).data("url");window.location=e}),$("#js-modal--create").on("show.bs.modal",function(){$("input").first().focus()}),$("#js-modal--create").on("hidden.bs.modal",function(){$("input").val(""),$("input[name=points_id]").val(userOptions.points_id)}),$("body").on("click",".js--update",function(){var t,e;t=$(this),e=t.text(),"created_at"==t.data("column")?(t.html('<input type="text" class="datetimepicker">'),t.find("input").click()):(t.html('<input type="number" id="js--update" placeholder="'+e+'">'),t.find("input").focus())}),$("body").on("keypress","#js--update",function(t){13==t.which&&d($(this))}),$("body").on("focusout","#js--update",function(){d($(this))}),$("body").on("click",".js--delete",function(t){t.preventDefault(),$(this).attr("id","active"),$("#js-modal--delete").modal("show")}),$("body").on("click","#js--delete",function(t){t.preventDefault();var e,a;e=$("#active").parents("tr"),a=e.data("id"),$.ajax({url:base_url+"/"+segment1+"/"+segment2+"/delete/"+a,type:"post",dataType:"json",data:{type:$("#active").parents("tbody").data("type")},beforeSend:function(){LoaderStart()},complete:function(t,a,s){o(t,e)}})}),$("#js-modal--delete").on("hidden.bs.modal",function(){$(".js--delete").removeAttr("id")}),$("body").on("click","#js-items--create",function(t){t.preventDefault();var e,a,s,n;e=$("#js-items--form").serialize(),a=$("#items_id").val(),0==a?(s=base_url+"/"+segment1+"/"+segment2,n="post"):(s=a,n="patch"),$.ajax({url:s,type:n,dataType:"json",data:e,beforeSend:function(){LoaderStart()},complete:function(t,e,a){r(t)}})}),$("body").on("click",".js-items--status",function(t){t.preventDefault();var e,a,s,r;e=$(this),a=e.attr("data-status"),s=e.parents("tr").data("id"),r={id:s,status:a},$.ajax({url:base_url+"/"+segment1+"/"+segment2+"/status",type:"patch",dataType:"json",data:r,beforeSend:function(){LoaderStart()},success:function(t){0==t.status&&(e.removeClass("btn-success").addClass("btn-danger"),e.html('<i class="fa fa-ban"></i>'),e.attr("data-status",t.status)),1==t.status&&(e.removeClass("btn-danger").addClass("btn-success"),e.html('<i class="fa fa-check"></i>'),e.attr("data-status",t.status))},error:function(t){AnswerError()}}).complete(function(){LoaderStop()})}),$("#js-item--barcode").focusout(function(){var t,e,a;t=$(this).val(),e={barcode:t},t&&$.ajax({url:base_url+"/"+segment1+"/"+segment2+"/search",type:"patch",dataType:"json",data:e,beforeSend:function(){LoaderStart()},success:function(t){0==t.status&&($("#item_id, #name, #price, #quantity").val(""),$("#js-item--sbm").text("Создать"),AnswerInfo("<strong>"+t.message+"</strong>. Будет создан новый")),1==t.status&&(a=JSON.parse(JSON.stringify(t.items)),$("#item_id").val(a.id),$("#name").val(a.name),$("#price").val(a.price),$("#quantity").val(a.quantity),$("#js-item--sbm").text("Обновить"),AnswerWarning("<strong>"+t.message+"</strong>. Будет обновлен"))},error:function(t){AnswerError()}}).complete(function(){LoaderStop()})}),$("body").on("click",".js-items--print-review",function(t){t.preventDefault();var e=$(this).data("barcode");$("#print-modal strong").html(e),$("#js-items--print-review").val(e),$("#print-modal").modal("show")}),$("#print-modal").on("shown.bs.modal",function(){$("#print-quantity").numeric({decimal:!1,negative:!1}).focus()}),$("#print-quantity").keyup(function(){"0"==$(this).val()&&$(this).val(1)}),$("#js-items--print-cancel").click(function(t){$(".full").addClass("hidden"),$(".row").removeClass("hidden"),$("#print-modal").modal("hide")}),$("#js-items--print-review").click(function(t){$("#print-modal").modal("hide"),$(".row").addClass("hidden");var e,a,s,r,n,o;e="",a=$("#js-items--print-review").val(),s=$("#print-quantity").val(),r={barcode:a},$.ajax({url:base_url+"/"+segment1+"/"+segment2+"/barcode/generate",type:"patch",dataType:"json",data:r,beforeSend:function(){LoaderStart()},success:function(t){if(200==t.status){for(n=JSON.stringify(t.item),o=JSON.parse(n),i=0;i<s;i++)e+='<div class="box">',e+='<div class="header">ИП Зибарева С.С.</div>',e+='<div class="description"><span>'+o.barcode+"</span><time>"+t.time+"</time></div>",e+='<div class="title">'+o.name+"</div>",e+='<div class="barcode">'+t.barcode+"<br>",e+="<span>"+o.barcode+"</span></div>",e+='<div class="footer"><p>'+o.price+"</p>",e+="<span>руб. за шт.</span>",e+="</div></div>";$(".full").removeClass("hidden"),$(".print").html(e)}},error:function(t){AnswerError()}}).complete(function(){LoaderStop()})}),$("body").on("click","#js--items-print",function(t){t.preventDefault(),window.print()}),$("body").on("click","#js-orders-supply--create",function(t){t.preventDefault();var e,a,s,r,n,o;e=JSON.parse(localStorage.getItem("items")),totalSum=e.totalSum,a=e.type,s=e.discount,r=e.counterparty,n=JSON.stringify(e.items),o={totalSum:totalSum,type:a,discount:s,counterparty:r,items:n},$.ajax({url:base_url+"/"+segment1+"/"+segment2,type:"post",dataType:"json",data:o,beforeSend:function(){LoaderStart()},success:function(t){1==t.status&&(OrderClear(),AnswerSuccess('<a href="'+base_url+"/"+segment1+"/"+segment2+"/"+t.message+'">Создано</a>'))},error:function(t){AnswerError()}}).complete(function(){LoaderStop()})}),$("body").on("click",".js-order--type",function(t){var e,a,s;e=$(this),a=e.val(),localStorage&&(localStorage["order-type-index"]=e.index()),s=JSON.parse(localStorage.getItem("items")),s.type=a,localStorage.setItem("items",JSON.stringify(s)),OrderButtonActive(e)}),$("body").on("click",".js-order--discount",function(t){var e,a;e=$(this),localStorage&&(localStorage["order-discount-index"]=e.index()),a=JSON.parse(localStorage.getItem("items")),$(this).hasClass("active")?($(this).removeClass("active"),a.discount=!1):($(this).addClass("active"),a.discount=!0),localStorage.setItem("items",JSON.stringify(a))}),$("body").on("change",".js-supply--counterparty",function(t){var e,a;e=Number($("option:selected",this).val()),a=JSON.parse(localStorage.getItem("items")),a.counterparty=e,localStorage.setItem("items",JSON.stringify(a))});var l;$("#some_id").keyup(function(){window.clearTimeout(l),$("#some_id").val().length>2&&(l=setTimeout(function(){},1e3))}),$("#js-items--search").keyup(function(t){t.preventDefault();var e,a,s,r,n;window.clearTimeout(l),e=$(this).val(),a=localStorage.getItem("items"),s={barcode:e,items:a},e.length>10&&setTimeout(function(){$.ajax({url:base_url+"/"+segment1+"/items/search",type:"patch",dataType:"json",data:s,beforeSend:function(){LoaderStart()},success:function(t){if(2==t.status&&AnswerWarning('<button id="js-item--barcode-create" class="btn btn-danger">Отправить штрихкод</button>'),1==t.status&&($(".order").removeClass("hidden"),$("#alert").removeClass().html(""),r=JSON.parse(JSON.stringify(t.data)),OrderItemPaste(r)),0==t.status){AnswerWarning(t.message),$("table tr").removeClass("info");var e=$('*[data-item="'+t.data+'"]').addClass("info");e.find(".js-order--update-quantity").html(n)}},error:function(t){AnswerError()}}).complete(function(){LoaderStop()})},2e3)}),$("body").on("click",".js-order--update",function(){var t,e;t=$(this),e=t.text(),t.html('<input type="number" id="js-order--update" placeholder="'+e+'">'),t.find("input").focus()}),$("body").on("keypress","#js-order--update",function(t){13==t.which&&OrderUpdate($(this))}),$("body").on("focusout","#js-order--update",function(){OrderUpdate($(this))}),$("body").on("click",".js-order--remove",function(){var t,e,a,s,r,n,o;t=$(this).parents("tr"),e=t.data("item"),a=t.find(".js-order--price").val(),s=t.find(".js-order--quantity").val(),r=$(".order-table tbody tr").length,n=JSON.parse(localStorage.getItem("items")),o=n.items.findIndex(function(t,a){return t.item===e}),n.items.splice(o,1),localStorage.setItem("items",JSON.stringify(n)),t.remove(),1==r?OrderClear():(OrderTotalSum(),localStorage.setItem("order-table",$(".order-table").html()))}),$("body").on("click","#js-item--barcode-create",function(t){t.preventDefault();var e,a;e=$("#js--item-search").val(),a={barcode:e},$.ajax({url:base_url+"/"+segment1+"/items/barcode",type:"post",dataType:"json",data:a,beforeSend:function(){LoaderStart()},success:function(t){0==t.status&&AnswerError(t.message),1==t.status&&AnswerSuccess(t.message)},error:function(t){AnswerError()}}).complete(function(){LoaderStop()})}),$("body").on("click","#js-costs--create",function(t){t.preventDefault();var e=$("#js-costs--form").serializeArray();e.push({name:"ccosts_id",value:segment3}),$.ajax({url:base_url+"/"+segment1+"/"+segment2,type:"post",dataType:"json",data:e,beforeSend:function(){LoaderStart()},complete:function(t,e,a){r(t)}})}),$("body").on("click","#js-discounts--create",function(t){t.preventDefault();var e=$("#js-discounts--form").serialize();$.ajax({url:base_url+"/"+segment1+"/"+segment2,type:"post",dataType:"json",data:e,beforeSend:function(){LoaderStart()},complete:function(t,e,a){r(t)}})}),$.ajaxSetup({headers:{"X-CSRF-Token":$('meta[name="_token"]').attr("content")}})});