{"version":3,"sources":["main.js","settings.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnkCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["/**\n * @author Robert Slooo\n * @mail   borisworking@gmail.com\n */\n\n/*\n\tMain functions\t\n\tThis global functions of the entire project\n*/\n\n// list column type\nfunction getTypeColumn(column)\n{\n\tvar type;\n\tswitch(column)\n\t{\n\t\tcase 'name':\n\t\t\ttype = 'string';\n\t\tbreak;\n\n\t\tcase 'price':\n\t\tcase 'items_price':\n\t\tcase 'sum':\n\t\t\ttype = 'numeric';\n\t\tbreak;\n\n\t\tcase 'items_quantity':\n\t\tcase 'percent':\n\t\t\ttype = 'integer';\n\t\tbreak;\n\n\t\tcase 'created_at':\n\t\tcase 'date':\n\t\t\ttype = 'date';\n\t\tbreak;\n\n\t\tdefault:\n\t\t\ttype = 'string';\n\t\tbreak;\n\t}\n\n\treturn type;\n}\n\n// parse column\nfunction getValueColumn(type, column)\n{\n\tvar parse;\n\tswitch(type)\n\t{\n\t\tcase 'string':\n\t\t\tparse = column.toString();\n\t\tbreak;\n\n\t\tcase 'numeric':\n\t\t\tparse = number_format(column, 0, ' ', ' ');\n\t\tbreak;\n\n\t\tcase 'integer':\n\t\t\tparse = Number(column);\n\t\tbreak;\n\n\t\tcase 'date':\n\t\t\tparse = column.toString();\n\t\tbreak;\n\t}\n\n\treturn parse;\n}\n\n// remove dublicate qty stock\nfunction removeDuplicates(arr, prop) {\n\tvar new_arr = [];\n\tvar lookup  = {};\n\n\tfor (var i in arr) {\n\t\tlookup[arr[i][prop]] = arr[i];\n\t}\n\n\tfor (i in lookup) {\n\t\tnew_arr.push(lookup[i]);\n\t}\n\n\treturn new_arr;\n}\n\n// find elem in array to object\nfunction functiontofindIndexByKeyValue(arraytosearch, key, valuetosearch) {\n\tfor (var i = 0; i < arraytosearch.length; i++) {\n \t\tif (arraytosearch[i][key] == valuetosearch) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn 'z';\n}\n\nfunction Answer(type, message)\n{\n\t$('#alert').removeClass().html('');\n\tswitch(type)\n\t{\n\t\tcase 'success':\n\t\t\t$('#js-modal--create').modal('hide');\n\t\t\t$('#alert').removeClass().addClass('alert alert-success').html(message);\t\t\n\t\tbreak;\n\n\t\tcase 'error':\n\t\t\t$('#js-modal--create').modal('hide');\n\t\t\t$('#alert').removeClass().addClass('alert alert-danger').html('Ошибка запроса');\t\n\t\tbreak;\n\n\t\tcase 'info':\n\t\t\t$('#js-modal--create').modal('hide');\n\t\t\t$('#js-modal--delete').modal('hide');\n\t\t\t$('#alert').removeClass().addClass('alert alert-info').html(message);\t\n\t\tbreak;\n\n\t\tcase 'warning':\n\t\t\t$('#js-modal--create').modal('hide');\n\t\t\t$('#alert').removeClass().addClass('alert alert-warning').html(message);\t\n\t\tbreak;\n\t}\n}\n\n// loader start\nfunction LoaderStart()\n{\n\t//$('#js-modal--create').modal('hide');\n\t$('body').append('<div class=\"loader\"></div>');\t\n}\n\n// loader stop\nfunction LoaderStop()\n{\n\t//$('#alert').removeClass().html('');\n\t$('.loader').remove();\n\t//$('#js-modal--create').modal('hide');\n}\n\n// number format\nfunction number_format( number, decimals, dec_point, thousands_sep ) {\n\n\tvar i, j, kw, kd, km;\n\n\t// input sanitation & defaults\n\tif( isNaN(decimals = Math.abs(decimals)) ){\n\t\tdecimals = 2;\n\t}\n\tif( dec_point == undefined ){\n\t\tdec_point = \",\";\n\t}\n\tif( thousands_sep == undefined ){\n\t\tthousands_sep = \".\";\n\t}\n\n\ti = parseInt(number = (+number || 0).toFixed(decimals)) + \"\";\n\n\tif( (j = i.length) > 3 ){\n\t\tj = j % 3;\n\t} else{\n\t\tj = 0;\n\t}\n\n\tkm = (j ? i.substr(0, j) + thousands_sep : \"\");\n\tkw = i.substr(j).replace(/(\\d{3})(?=\\d)/g, \"$1\" + thousands_sep);\n\t//kd = (decimals ? dec_point + Math.abs(number - i).toFixed(decimals).slice(2) : \"\");\n\tkd = (decimals ? dec_point + Math.abs(number - i).toFixed(decimals).replace(/-/, 0).slice(2) : \"\");\n\n\treturn km + kw + kd;\n}\n\n// don't close\n$('.modal').modal({\n    backdrop: 'static',\n    keyboard: false,\n    show: false,\n});\n\n/**\n * Parse data in graphic\n * @return data\n */\nfunction graphParseData(data, type)\n{\n\tvar obj = {}, arr = [], val, positive, result;\n\n\tval = data[1] < 0 ? Math.abs(data[1]) : data[1];\n\tvalue = val == undefined ? 0 : val;\n\tpositive = data[1] < 0 ? false : true;\n\n\tswitch(type)\n\t{\n\t\tcase true:\n\t\t\tarr.push(data[0]);\n\t\t\tarr.push(value);\n\t\t\tarr.push(positive);\n\t\t\treturn arr;\n\t\tbreak;\n\n\t\tcase false:\n\t\t\tobj.name = data[0];\n\t\t\tobj.y = value;\n\t\t\tobj.positive = positive;\n\t\t\treturn obj;\n\t\tbreak;\n\n\t\tdefault:\n\t\t\treturn false;\n\t\tbreak;\n\t}\n}\n\n$(document).ready(function() {\n\n\tfunction userPermissions(option)\n\t{\n\t\t$.each(option, function(i, param){\n\t\t\tswitch(param)\n\t\t\t{\n\t\t\t\tcase 'update':\n\t\t\t\t\t$('.table tbody tr td[data-column]').each(function(){\n\t\t\t\t\t\t$(this).addClass('js--update');\n\t\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'delete':\n\t\t\t\t\thtml = '<td class=\"col-md-1\"><button class=\"btn btn-danger btn-circle js--delete\"><i class=\"fa fa-remove\"></i></button></td>';\n\t\t\t\t\t$('.table tbody tr').each(function(){\n\t\t\t\t\t\t$(this).append(html);\n\t\t\t\t\t});\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'status':\n\t\t\t\t\t$('.table tbody tr td button[data-status]').each(function(){\n\t\t\t\t\t\t$(this).addClass('js-items--status');\n\t\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Функция создающая ссылки для пользователя\n\t * @param  {array} option массив с наименованием ссылок\n\t */\n\tfunction userLinks(option)\n\t{\n\t\t// Menu links\n\t\thtml = '<li class=\"dropdown\">';\n\t\t    html += '<a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-expanded=\"false\">';\n\t\t        html += userOptions.username+' <span class=\"caret\"></span>';\n\t\t    html += '</a>';\n\t\t    html += '<ul class=\"dropdown-menu\" role=\"menu\">';\n\n\t\t    switch(parseInt(userOptions.status))\n\t\t    {\n\t\t    \tcase 1:\n\t\t    \t\thtml += '<li><a href=\"'+base_url+'/'+segment1+'/items\">Товары</a></li>';\n\t            \thtml += '<li><a href=\"'+base_url+'/'+segment1+'/orders\">Заказы</a></li>';\n\t\t    \tbreak;\n\n\t\t    \tcase 2:\n\t\t\t    \thtml += '<li><a href=\"'+base_url+'/'+segment1+'/items\">Товары</a></li>';\n\t\t\t    \thtml += '<li><a href=\"'+base_url+'/'+segment1+'/orders\">Заказы</a></li>';\n\t\t\t    \thtml += '<li><a href=\"'+base_url+'/'+segment1+'/supply\">Приходы</a></li>';\n\t\t\t    \thtml += '<li><a href=\"'+base_url+'/'+segment1+'/costs\">Расходы</a></li>';\n\t\t\t    \thtml += '<li><a href=\"'+base_url+'/'+segment1+'/analytics\">Аналитика</a></li>';\n\t\t    \tbreak;\n\n\t\t    \tcase 3:\n\t\t    \t\thtml += '<li><a href=\"'+base_url+'/'+segment1+'/items\">Товары</a></li>';\n\t\t    \t\thtml += '<li><a href=\"'+base_url+'/'+segment1+'/orders\">Заказы</a></li>';\n\t\t    \t\thtml += '<li><a href=\"'+base_url+'/'+segment1+'/supply\">Приходы</a></li>';\n\t\t    \t\thtml += '<li><a href=\"'+base_url+'/'+segment1+'/costs\">Расходы</a></li>';\n\t\t    \t\thtml += '<li><a href=\"'+base_url+'/'+segment1+'/discounts\">Скидки</a></li>';\n\t\t    \tbreak;\n\n\t\t\t\tcase 4:\n\t\t    \t\thtml += '<li><a href=\"'+base_url+'/'+segment1+'/items\">Товары</a></li>';\n\t\t    \t\thtml += '<li><a href=\"'+base_url+'/'+segment1+'/orders\">Заказы</a></li>';\n\t\t    \t\thtml += '<li><a href=\"'+base_url+'/'+segment1+'/supply\">Приходы</a></li>';\n\t\t    \t\thtml += '<li><a href=\"'+base_url+'/'+segment1+'/costs\">Расходы</a></li>';\n\t\t    \t\thtml += '<li><a href=\"'+base_url+'/'+segment1+'/analytics\">Аналитика</a></li>';\n\t\t    \t\thtml += '<li><a href=\"'+base_url+'/'+segment1+'/discounts\">Скидки</a></li>';\n\t\t    \tbreak;\n\n\t\t    \tdefault:\n\t\t    \t\treturn false;\n\t\t    \tbreak;\n\t\t    }\n\n\t\t    \thtml += '<li><a href=\"/logout\"><i class=\"fa fa-btn fa-sign-out\"></i>Выйти</a></li>';\n\t\t    html += '</ul>';\n\t\thtml += '</li>';\n\n\t\t$('ul.nav.navbar-nav.navbar-right').append(html);\n\n\t\tif(option) {\n\n\t\tvar param = []; checkOption = [];\n\n\t\t$('ul.nav.navbar-nav.navbar-right li.js--url-user-links').each(function(){\n\t\t\tvar str = $(this).attr('id').substring(8);\n\t\t\tcheckOption.push(str);\n\t\t});\n\n\t\tif(checkOption.length > 0)\n\t\t{\n\t\t\tArray.prototype.diff = function(a) {\n\t\t\t    return this.filter(function(i){return a.indexOf(i) < 0;});\n\t\t\t};\n\t\t\tparam = option.diff(checkOption);\n\t\t} else {\n\t\t\tparam = option;\n\t\t}\n\n\t\t$.each(param, function(i, param){\n\t\t\tswitch(param)\n\t\t\t{\n\t\t\t\tcase 'create':\n\t\t\t\t\t$('ul.navbar-right').prepend('<li class=\"js--url-user-links\" id=\"js--url-create\"><a href=\"'+segment2+'/create\">создать</a></li>');\t\t\t\t\t\t\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'create-modal':\n\t\t\t\t\t$('ul.navbar-right').prepend('<li class=\"js--url-user-links\" id=\"js--url-create-modal\"><a href=\"#\" data-toggle=\"modal\" data-target=\"#js-modal--create\">создать</a></li>');\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'date-range':\n\t\t\t\t\thtml = '<li class=\"dropdown js--url-user-links\" id=\"js--url-date-range\">'\n\t                html += '<a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-expanded=\"false\">';\n\t                html += 'настройки <span class=\"caret\"></span>';\n\t                html += '</a>';\n\t                html += '<ul class=\"dropdown-menu dropdown-menu--lg\" role=\"menu\">';\n\t                html += '<li class=\"dropdown-header\">Выбрать период</li>';\n\t                html += '<li>';\n\t                \thtml += '<div class=\"col-md-12\">';\n\t                \thtml += '<form url=\"'+segment1+'/'+segment2+'/date\" method=\"post\" id=\"js-date_range--form\">';\n\n\t                \thtml +=\t'<div class=\"form-group col-md-push-1\">';\n\t                \t\thtml +=\t'<div class=\"input-group date datetimepicker\">';\n\t                \t\thtml +=\t'<input type=\"text\" name=\"date_start\" class=\"form-control input-sm\" placeholder=\"Дата начала\">';\n\t                \t\thtml += '<span class=\"input-group-addon\">';\n\t                \t\t\thtml += '<span class=\"glyphicon glyphicon-calendar\"></span>';\n\t                \t\thtml += '</span>';\n\t                \t\thtml += '</div>';\n\t                \thtml += '</div>';\n\n\t                \thtml += '<div class=\"form-group col-md-push-1\">';\n\t                \t\thtml += '<div class=\"input-group date datetimepicker\">';\n\t                \t\thtml += '<input type=\"text\" name=\"date_end\" class=\"form-control input-sm\" placeholder=\"Дата конца\">';\n\t                \t\thtml += '<span class=\"input-group-addon\">';\n\t                \t\t\thtml += '<span class=\"glyphicon glyphicon-calendar\"></span>';\n\t                \t\thtml += '</span>';\n\t                \t\thtml += '</div>';\n\t                \thtml += '</div>';\n\t                \t\n\t                \thtml += '<button type=\"button\" class=\"btn btn-primary btn-sm\" id=\"js-date_range--sbm\">Показать</button>';\n\t                \thtml += '</form>';\n\t                \thtml += '</div>';\n\t                html += '</li>';\n\t                html += '<li class=\"divider\"></li>';\n\t                html += '</ul>';\n\t                html += '</li>';\n\n\t                $('ul.navbar-right').prepend(html);\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'graphics':\n\t\t\t\t\thtml = '<li class=\"dropdown\" id=\"js--url-graphics\">';\n\t\t\t\t\t\thtml += '<a href=\"'+base_url+'/'+segment1+'/'+segment2+'/graphics\">графики</a>';\n\t\t\t\t\thtml += '</li>';\n\n\t\t\t\t\t$('ul.navbar-right').prepend(html);\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'analyzes':\n\t\t\t\t\thtml = '<li class=\"dropdown\" id=\"js--url-analyzes\">';\n\t\t\t\t\t    html += '<a href=\"#\" class=\"dropdown-toggle\" data-toggle=\"dropdown\" role=\"button\" aria-expanded=\"false\">';\n\t\t\t\t\t        html += 'анализы <span class=\"caret\"></span>';\n\t\t\t\t\t    html += '</a>';\n\n\t\t\t\t\t    html += '<ul class=\"dropdown-menu dropdown-menu--lg\" role=\"menu\">';\n\t\t\t\t\t        html += '<li><a href=\"'+base_url+'/'+segment1+'/'+segment2+'/abc\">ABC</a></li>';\n\t\t\t\t\t        html += '<li><a href=\"'+base_url+'/'+segment1+'/'+segment2+'/xyz\">XYZ</a></li>';\n\t\t\t\t\t    html += '</ul>';\n\t\t\t\t\thtml += '</li>';\n\n\t\t\t\t\t$('ul.navbar-right').prepend(html);\n\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\treturn false;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * The global validation\n\t * @param  {object}  answer request server\n\t * @param  {string}  method type validation\n\t * @param  {object}  elem this   \n\t * @param  {Boolean} glob or local method\n\t */\n\tfunction validationInputs(answer, method, elem, glob = false)\n\t{\n\t\tvar json = JSON.parse(answer.responseText);\n\n\t\tif(glob === true)\n\t\t{\n\t\t\tswitch(method)\n\t\t\t{\n\t\t\t\tcase 'update':\n\t\t\t\tswitch(answer.status)\n\t\t\t\t{\n\t\t\t\t\tcase 200:\n\t\t\t\t\t\tvar type = getTypeColumn(elem.parent('td').data('column'));\n\t\t\t\t\t\tvar val = getValueColumn(type, elem.val());\n\t\t\t\t\t\telem.removeAttr('id');\n\t\t\t\t\t\t$('.table tbody tr').removeClass();\n\t\t\t\t\t\telem.parents('tr').addClass('info');\n\t\t\t\t\t\telem.parent('td').html(val);\n\t\t\t\t\t\ttotalSumAndDiscount(json.data);\n\t\t\t\t\t\tAnswer('info', json.message);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 422:\n\t\t\t\t\t\t$('.table tbody tr').removeClass();\n\t\t\t\t\t\telem.parents('tr').addClass('warning');\n\t\t\t\t\t\telem.parent('td').html(elem.attr('placeholder'));\n\t\t\t\t\t\tAnswer('warning', json.message.value);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 404:\n\t\t\t\t\t\tAnswer('error');\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tAnswer('error');\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'delete':\n\t\t\t\tswitch(answer.status)\n\t\t\t\t{\n\t\t\t\t\t// success\n\t\t\t\t\tcase 200:\n\t\t\t\t\t\tAnswer('info', json.message);\n\t\t\t\t\t\telem.remove();\n\t\t\t\t\t\ttotalSumAndDiscount();\n\t\t\t\t\tbreak;\n\n\t\t\t\t\t// error validation\n\t\t\t\t\tcase 422:\n\t\t\t\t\t\tAnswer('error');\n\t\t\t\t\tbreak;\n\n\t\t\t\t\t// redirect\n\t\t\t\t\tcase 301:\n\t\t\t\t\t\twindow.location.href = base_url +'/'+ segment1 +'/'+ segment2;\t\n\t\t\t\t\tbreak;\n\n\t\t\t\t\t// not found\n\t\t\t\t\tcase 404:\n\t\t\t\t\t\tAnswer('error');\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tAnswer('error');\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'date-range':\n\t\t\t\t$('.col-body h2').remove();\n\n\t\t\t\tswitch(answer.status)\n\t\t\t\t{\n\t\t\t\t\tcase 200:\n\t\t\t\t\t\thtml = \"\";\n\t\t\t\t\t\t\n\t\t\t\t\t\t$('.table').removeClass('hidden');\n\t\t\t\t\t\t$('.col-footer').removeClass('hidden');\n\n\t\t\t\t\t\tswitch(segment2)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcase 'costs':\n\t\t\t\t\t\t\t\tfor(row in json.data)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\thtml += '<tr data-id=\"'+json.data[row].id+'\">';\n\t\t\t\t\t\t\t\t\thtml += '<td class=\"col-md-1\">'+json.data[row].id+'</td>';\n\t\t\t\t\t\t\t\t\thtml += '<td class=\"col-md-1\">'+json.data[row].date+'</td>';\n\t\t\t\t\t\t\t\t\thtml += '<td class=\"col-md-9 js--totalSum\" data-column=\"sum\">'+json.data[row].sum+'</td>';\n\t\t\t\t\t\t\t\t\thtml += '</tr>';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'supply':\n\t\t\t\t\t\t\t\tfor(row in json.data)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\thtml += '<tr data-id=\"'+json.data[row].id+'\">';\n\t\t\t\t\t\t\t\t\thtml += '<td class=\"col-md-1 js--url-link\" data-url=\"'+segment2 +'/'+ json.data[row].id+'\">'+json.data[row].id+'</td>';\n\t\t\t\t\t\t\t\t\thtml += '<td class=\"col-md-1\">'+json.data[row].date+'</td>';\n\t\t\t\t\t\t\t\t\thtml += '<td class=\"col-md-9 js--totalSum data-column=\"sum\">'+json.data[row].sum+'</td>';\n\t\t\t\t\t\t\t\t\thtml += '</tr>';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase 'orders':\n\t\t\t\t\t\t\t\tfor(row in json.data)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\thtml += '<tr data-id=\"'+json.data[row].id+'\">';\n\t\t\t\t\t\t\t\t\thtml += '<td class=\"col-md-1 js--url-link\" data-url=\"'+segment2 +'/'+ json.data[row].id+'\">'+json.data[row].id+'</td>';\n\t\t\t\t\t\t\t\t\thtml += '<td class=\"col-md-1\">'+json.data[row].date+'</td>';\n\t\t\t\t\t\t\t\t\thtml += '<td class=\"col-md-4 js--totalSum\">'+json.data[row].sum+'</td>';\n\t\t\t\t\t\t\t\t\thtml += '<td class=\"col-md-4\">'+json.data[row].sum_discount+'</td>';\n\t\t\t\t\t\t\t\t\thtml += '<td class=\"col-md-2\">'+json.data[row].type+'</td>';\n\t\t\t\t\t\t\t\t\thtml += '</tr>';\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t$('.table tbody').html(html);\n\t\t\t\t\t\t$('.totalSum').html('Итого: ' + json.extra.totalSum + ' &#8381;');\n\t\t\t\t\t\t//userAccess();\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 422:\n\t\t\t\t\t\t$('.table').addClass('hidden');\n\t\t\t\t\t\t$('.col-footer').addClass('hidden');\n\t\t\t\t\t\t$('.col-body').append('<h2>'+json.data+'</h2>');\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tAnswer('error');\n\t\t\t\t\tbreak;\n\t\t\t\t\t// скрыть dropdown\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tAnswer('error');\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} else {\n\t\t\tswitch(segment2)\n\t\t\t{\n\t\t\t\tcase 'items':\n\t\t\t\tswitch(method)\n\t\t\t\t{\n\t\t\t\t\tcase 'create':\n\t\t\t\t\tif(answer.status === 200)\n\t\t\t\t\t{\n\t\t\t\t\t\tjson.data.price  = number_format(json.data.price, 0, ' ', ' ');\n\n\t\t\t\t\t\thtml =  '<tr data-id=\"'+json.data.id+'\">'; \n\t\t\t\t\t\thtml += '<td>'+json.data.barcode+'</td>';\n\t\t\t\t\t\thtml += '<td>'+json.data.name+'</td>';\n\t\t\t\t\t\thtml += '<td class=\"js--update\" data-column=\"price\">'+json.data.price+'</td>';\n\t\t\t\t\t\thtml += '<td><button class=\"btn btn-circle btn-success js-items--status\" data-status=\"'+json.data.status+'\"><i class=\"fa fa-check\"></i></button></td>';\n\t\t\t\t\t\t//html += '<td><button type=\"button\" data-barcode=\"'+json.data.barcode+'\" class=\"btn btn-circle btn-primary js-items--print-review\"><i class=\"fa fa-print\"></i></button></td>';\n\t\t\t\t\t\thtml += '</tr>';\n\n\t\t\t\t\t\t$('.table tbody').prepend(html);\n\t\t\t\t\t\t$('.table tbody tr').removeClass().first().addClass('success');\n\t\t\t\t\t\tAnswer('success', json.message);\n\t\t\t\t\t\ttotalSumAndDiscount();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tkeys = Object.keys(json);\n\n\t\t\t\t\t\t$(\"form input\").each(function(){\n\t\t\t\t\t\t\tinput = $(this);\n\t\t\t\t\t\t\tif(keys.indexOf(input.attr('name')) != -1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tinput.addClass('validate-error');\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tinput.addClass('validate-success');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'status':\n\t\t\t\t\tif(answer.status === 200)\n\t\t\t\t\t{\n\t\t\t\t\t\tif(json.data === 1)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\telem.removeClass('btn-danger').addClass('btn-success');\n\t\t\t\t\t\t\telem.html('<i class=\"fa fa-check\"></i>');\n\t\t\t\t\t\t\telem.attr('data-status', answer.status);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\telem.removeClass('btn-success').addClass('btn-danger');\n\t\t\t\t\t\t\telem.html('<i class=\"fa fa-ban\"></i>');\n\t\t\t\t\t\t\telem.attr('data-status', json.data);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tAnswer('error');\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'supply':\n\t\t\t\tcase 'orders':\n\t\t\t\tswitch(method)\n\t\t\t\t{\n\t\t\t\t\tcase 'create':\n\t\t\t\t\tif(answer.status === 200)\n\t\t\t\t\t{\n\t\t\t\t\t\torderClear();\n\t\t\t\t\t\tAnswer('success', '<a href=\"'+base_url + '/' + segment1 + '/' + segment2 + '/' + json.message +'\">Оформлен заказ #'+json.message+'</a>');\t\t\t\t\t\n\t\t\t\t\t} else {\n\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'create--barcode':\n\t\t\t\t\t\tAnswer('success', json.message);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'search':\n\t\t\t\t\tif(answer.status === 200)\n\t\t\t\t\t{\n\t\t\t\t\t\t$('.order').removeClass('hidden');\n\t\t\t\t\t\torderItemPaste(json.data);\n\t\t\t\t\t\t$('#js-items--search').val('');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tAnswer('warning', '<button id=\"js-items--barcode-create\" data-barcode=\"'+$('#js-items--search').val()+'\" class=\"btn btn-danger\">Отправить штрихкод</button>');\n\t\t\t\t\t\t$('#js-items--search').val('');\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'costs':\n\t\t\t\tswitch(method)\n\t\t\t\t{\n\t\t\t\t\tcase 'create':\n\t\t\t\t\tif(answer.status === 200)\n\t\t\t\t\t{\n\t\t\t\t\t\tdata = json.data;\n\t\t\t\t\t\tdata.date = moment(json.data.created_at, \"YYYY-MM-DD HH:mm:ss\").format('DD/MM/YYYY');\n\t\t\t\t\t\tdata.sum  = number_format(json.data.sum, 0, ' ', ' ');\n\n\t\t\t\t\t\thtml =  '<tr data-id=\"'+data.id+'\">';\n\t\t\t\t\t\thtml += '<td class=\"col-md-1\">'+data.id+'</td>';\n\t\t\t\t\t\thtml += '<td class=\"col-md-1\">'+data.date+'</td>';\n\t\t\t\t\t\thtml += '<td class=\"col-md-9 js--totalSum js--update\" data-column=\"sum\">'+data.sum+'</td>';\n\t\t\t\t\t\thtml += '<td class=\"col-md-1\"><button class=\"btn btn-circle btn-danger js--delete\"><li class=\"fa fa-remove\"></li></button></td>';\n\t\t\t\t\t\thtml += '</tr>';\n\n\t\t\t\t\t\t$('.table tbody').prepend(html);\n\t\t\t\t\t\t$('.table tbody tr').removeClass().first().addClass('success');\n\t\t\t\t\t\tAnswer('success', json.message);\n\t\t\t\t\t\ttotalSumAndDiscount();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tAnswer('error');\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\t\tcase 'discounts':\n\t\t\t\tswitch(method)\n\t\t\t\t{\n\t\t\t\t\tcase 'create':\n\t\t\t\t\tif(answer.status === 200)\n\t\t\t\t\t{\n\t\t\t\t\t\tjson.data.sum  = number_format(json.data.sum, 0, ' ', ' ');\n\n\t\t\t\t\t\thtml = '<tr data-id=\"'+json.data.id+'\">';\n\t\t\t\t\t\thtml += '<td class=\"col-md-1\">'+json.data.id+'</td>';\n\t\t\t\t\t\thtml += '<td class=\"col-md-5 js--update\" data-column=\"sum\">'+json.data.sum+'</td>';\n\t\t\t\t\t\thtml += '<td class=\"col-md-5 js--update\" data-column=\"percent\">'+json.data.percent+'</td>';\n\t\t\t\t\t\thtml += '<td class=\"col-md-1\"><button class=\"btn btn-danger btn-circle js--delete\"><i class=\"fa fa-remove\"></i></button></td>';\n\t\t\t\t\t\thtml += '</tr>';\n\n\t\t\t\t\t\t$('.table tbody').prepend(html);\n\t\t\t\t\t\t$('.table tbody tr').removeClass().first().addClass('success');\n\t\t\t\t\t\tAnswer('info', json.message);\n\t\t\t\t\t\ttotalSumAndDiscount();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tAnswer('error');\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tLoaderStop();\n\t}\n\n\t/**\n\t * Доступ пользователя\n\t * @return {status} уровень пользователя\n\t */\n\tfunction userAccess()\n\t{\n\t\tswitch(parseInt(userOptions.status))\n\t\t{\n\t\t\t// cachier\n\t\t\tcase 1:\n\t\t\t\tswitch(segment2)\n\t\t\t\t{\n\t\t\t\t\tcase 'orders':\t\t\t\t\t\n\t\t\t\t\t\tif(segment3.length == 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tuserLinks(['date-range', 'create']);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuserLinks();\n\t\t\t\t\t\t}\n\n\t\t\t\t\tcashierPageLoad();\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'items':\n\t\t\t\t\t\tuserLinks();\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tbreak;\n\n\t\t\t// manage\n\t\t\tcase 2:\n\t\t\t\tswitch(segment2)\n\t\t\t\t{\n\t\t\t\t\tcase 'items':\n\t\t\t\t\t\tuserLinks();\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'analytics':\n\t\t\t\t\t\tuserLinks(['analyzes', 'graphics']);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'orders':\n\t\t\t\t\t\tif(segment3.length == 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tuserLinks(['date-range']);\n\t\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'supply':\n\t\t\t\t\t\tif(segment3.length == 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tuserLinks(['date-range']);\n\t\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'costs':\n\t\t\t\t\t\tif(segment3.length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tuserLinks(['date-range']);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuserLinks();\n\t\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tbreak;\n\n\t\t\t// admin\n\t\t\tcase 3:\n\t\t\t\tswitch(segment2)\n\t\t\t\t{\n\t\t\t\t\tcase 'items':\n\t\t\t\t\t\tuserLinks(['create-modal']);\n\t\t\t\t\t\tuserPermissions(['update', 'delete', 'status']);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'orders':\n\t\t\t\t\t\tif(segment3.length == 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tuserLinks(['date-range']);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuserLinks();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tuserPermissions(['delete']);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'supply':\n\t\t\t\t\t\tif(segment3.length == 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tuserLinks(['date-range', 'create']);\n\t\t\t\t\t\t\tuserPermissions(['update']);\t\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuserLinks();\n\t\t\t\t\t\t\tuserPermissions(['update', 'delete']);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif(segment3 == 'create')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcashierPageLoad();\n\t\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'costs':\n\t\t\t\t\t\tif(segment3.length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tuserLinks(['date-range', 'create-modal']);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuserLinks();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tuserPermissions(['update', 'delete']);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'discounts':\n\t\t\t\t\t\tuserLinks();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tbreak;\n\n\t\t\t// igor\n\t\t\tcase 4:\n\t\t\t\tswitch(segment2)\n\t\t\t\t{\n\t\t\t\t\tcase 'items':\n\t\t\t\t\t\tuserLinks(['create-modal'])\n\t\t\t\t\t\tuserPermissions(['update', 'status']);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'orders':\n\t\t\t\t\t\tif(segment3.length == 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tuserLinks(['date-range']);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tuserPermissions(['delete']);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'supply':\n\t\t\t\t\t\tif(segment3.length == 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tuserLinks(['date-range', 'create']);\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tuserPermissions(['update', 'delete']);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'costs':\n\t\t\t\t\t\tif(segment3.length > 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tuserLinks(['date-range', 'create-modal']);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tuserPermissions(['update', 'delete']);\n\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'analytics':\n\t\t\t\t\t\tuserLinks(['analyzes', 'graphics']);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tif(typeof(userOptions) !== 'undefined')\n\t{\n\t\tuserAccess();\n\t}\n\n\t// total sum\n\tfunction totalSumAndDiscount(data)\n\t{\n\t\tvar line, totalSum = 0, totalSumDiscount = 0;\n\n\t\tif($('strong').hasClass('totalSum'))\n\t\t{\n\t\t\tif(data)\n\t\t\t{\n\t\t\t\tline = $('.table tbody').find(\"[data-id='\" + data.id + \"']\");\n\t\t\t\t$(line).find('td.js--totalSum').html(number_format(data.sum, 0, ' ', ' '));\t\t\t\n\t\t\t}\n\n\t\t\t$('td.js--totalSum').each(function(){\n\t\t\t\ttotalSum += parseFloat($(this).text().replace(/\\s/g, ''));\n\t\t\t});\n\n\t\t\t$('.totalSum').html('Итого ' + number_format(totalSum, 0, ' ', ' ') + ' &#8381;');\t\n\t\t}\n\n\t\t// пока непонятно как считать скидку при изменениях.\n\t\tif($('strong').hasClass('totalSumDiscount'))\n\t\t{\n\t\t\t$('.js--sum-discount').each(function(){\n\t\t\t    totalSumDiscount += parseFloat($(this).text().replace(/\\s/g, ''));\n\t\t\t});\n\n\t\t\t$('.totalSumDiscount').html('Итого со скидкой ' + number_format(totalSumDiscount, 0, ' ', ' ') + ' &#8381;');\n\t\t}\n\t}\n\n\t// datepicker\n\t$('.datetimepicker').datetimepicker(\n\t\t{locale: 'ru', format: 'DD/MM/YYYY'}\n\t);\n\n\t// datetimepicker update\n\t$('body').on('focus', '.datetimepickerCall', function(){\n\t\tvar oldDate = moment($(this).attr('placeholder'), 'DD/MM/YYYY');\n\t    $(this).datetimepicker({defaultDate: oldDate, locale: 'ru', format: 'DD/MM/YYYY'});\n\t});\n\n\t// DATE RANGE\n\t$('#js-date_range--sbm').click(function(e){\n\t\te.preventDefault();\n\n\t\tvar data, url, html, json;\n\t\tdata = $('#js-date_range--form').serializeArray();\n\t\tdata.push({name: 'id', value: segment3});\n\n\t\t$.ajax({\n\t\t\turl \t : base_url + '/' + segment1 + '/' + segment2 + '/' + 'date',\n\t\t\ttype \t : \"patch\",\n\t\t\tdataType : \"json\",\n\t\t\tdata \t : data,\n\n\t\t\tbeforeSend: function(){\n\t\t\t\t$('.dropdown').removeClass('open');\n\t\t        LoaderStart();\n\t\t    },\n\n\t        complete: function(answer, xhr, settings){\n\t    \t    validationInputs(answer, 'date-range', false, true);\n\t        }\n\t\t});\n\t});\n\n\t// link url\n\t$('body').on('click', '.js--url-link', function(e){\n\t\te.preventDefault();\n\t\tvar url = $(this).data('url');\n\t    window.location = url;\n\t});\n\n\t// ---------- CREATE ----------\n\n\t$('#js-modal--create').on('show.bs.modal', function(){\n\t\t$('input').first().focus();\n\t});\n\n\t$('#js-modal--create').on('hidden.bs.modal', function(){\n\t\t$('input').val('');\n\t\t$('input[name=points_id]').val(userOptions.points_id);\n\t});\n\n\t// ---------- UPDATE ----------\n\n\t// select update item order\n\t$('body').on('click', '.js--update', function(){\n\t\tvar elem, data, type;\n\t\t\n\t\telem = $(this);\n\t\tdata = elem.text();\n\t\ttype = getTypeColumn(elem.data('column'));\n\t\t\t\n\t\tswitch(type)\n\t\t{\n\t\t\tcase 'string':\n\t\t\t\telem.html('<input type=\"text\" id=\"js--update\" placeholder=\"'+data+'\">');\n\t\t\t\telem.find('input').focus();\t\t\t\n\t\t\tbreak;\n\n\t\t\tcase 'numeric':\n\t\t\t\telem.html('<input type=\"number\" id=\"js--update\" placeholder=\"'+data+'\">');\n\t\t\t\telem.find('input').focus();\t\t\t\n\t\t\tbreak;\n\n\t\t\tcase 'integer':\n\t\t\t\telem.html('<input type=\"number\" id=\"js--update\" placeholder=\"'+data+'\">');\n\t\t\t\telem.find('input').focus();\t\t\t\n\t\t\tbreak;\n\n\t\t\tcase 'date':\n\t\t\t\telem.html('<input type=\"text\" id=\"js--update\" class=\"datetimepickerCall\" placeholder=\"'+data+'\">');\n\t\t\t\telem.find('input').focus();\n\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\treturn false;\n\t\t\tbreak;\n\t\t}\n\t});\n\n\t// update press enter\n\t$('body').on('keypress', '#js--update', function(e){\n\t\tif(e.which == 13) {\n\t\t\tupdate($(this));\n\t\t}\n\t});\n\t\n\t// update focusout\n\t$('body').on('focusout', '#js--update', function(){\n\t\tupdate($(this));\n\t});\n\n\t// update\n\tfunction update(elem){\n\t\tvar id, line, column, value, data, json;\n\n\t\tif(elem.val() == 0 || elem.val().length == 0)\n\t\t{\n\t\t\telem.parent('td').html(elem.attr('placeholder'));\n\t\t} else {\n\n\t\t\tline   = elem.parents('tr');\n\t\t\tid \t   = line.data('id');\n\t\t\tcolumn = elem.parent('td').data('column');\n\t\t\tvalue  = elem.val();\n\t\t\ttype   = line.parents('tbody').data('type');\n\t\t\tdata   = {\"column\":column, \"value\":value, \"type\":type};\n\n\t\t\t$.ajax({\n\t\t\t\turl \t : base_url + '/' + segment1 + '/' + segment2 + '/' + id,\n\t\t\t\ttype \t : 'patch',\n\t\t\t\tdataType : 'json',\n\t\t\t\tdata \t : data,\n\n\t\t\t\tbeforeSend: function(){\n\t\t\t        LoaderStart();\n\t\t\t    },\n\n\t\t\t    complete: function(answer, xhr, settings){\n\t\t\t\t    validationInputs(answer, 'update', elem, true);\n\t\t\t    }\n\n\t\t\t});\n\t\t}\n\t}\n\n\t// ---------- DELETE ----------\n\n\t$('body').on('click', '.js--delete', function(e){\n\t\te.preventDefault();\n\n\t\t$(this).attr('id', 'active');\n\t\t$('#js-modal--delete').modal('show');\n\t});\n\n\t$('body').on('click', '#js--delete', function(e){\n\t\te.preventDefault();\n\n\t\tvar data, line, id;\n\n\t\tline = $('#active').parents('tr');\n\t\tid = line.data('id');\n\n\t\t$.ajax({\n\t\t\turl \t : base_url + '/' + segment1 + '/' + segment2 + '/' + 'delete' + '/' + id,\n\t\t\ttype \t : 'post',\n\t\t\tdataType : 'json',\n\t\t\tdata \t : {\"type\":$('#active').parents('tbody').data('type')},\n\n\t\t\tbeforeSend: function(){\n\t\t        LoaderStart();\n\t\t    },\n\n\t\t    complete: function(answer, xhr, settings){\n\t\t    \tvalidationInputs(answer, 'delete', line, true);\n\t\t    }\n\n\t\t});\n\t});\n\n\t$(\"#js-modal--delete\").on(\"hidden.bs.modal\", function (){ \n\t    $('.js--delete').removeAttr('id');\n\t});\n\n\n","/**\n * @author Robert Slooo\n * @mail   borisworking@gmail.com\n */\n\n/*\n\tSettings functions\n\tThis global functions of the entire project\n*/\n\n// csrf token add to post request\n$.ajaxSetup({\n\theaders: {\n\t  'X-CSRF-Token': $('meta[name=\"_token\"]').attr('content')\n\t}\n});\n\n});"],"sourceRoot":"/source/"}