{"version":3,"sources":["main.js","items.js","orders.js","supply.js","costs.js","settings.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvDA;AACA;AACA;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["/*\n\t------- MAIN FUNCTION ------- \n*/\n\n// cashier\nvar CashierPageLoad = function CashierPageLoad()\n{\n\tif(localStorage.getItem('order-table') == null)\n\t{\n\t\t$('.order').addClass('hidden');\n\t\t$('#js-item--search').val('').focus();\n\t} else {\n\t\tOrderTotalPrice();\n\t\tOrderTypeActive($('.js-order--type').eq(localStorage['order-type-index']));\n\t\t$('.order-table').removeClass('hidden').html(localStorage.getItem('order-table'));\n\t}\n}\n\n// clear order\nfunction OrderClear()\n{\n\tlocalStorage.clear();\n\t$('.order-table table tbody').html('');\n\t$('.js-order--type').removeClass('active');\n\tCashierPageLoad();\n}\n\n// update order\nfunction OrderUpdate(here)\n{\n\tvar parents \t= here.parents('tr');\n\tvar item \t \t= parents.data('item');\n\tvar placeholder = here.attr('placeholder');\n\n\tif(here.val().length == 0)\n\t{\n\t\tif(placeholder.length > 0)\n\t\t{\n\t\t\there.val(placeholder);\n\t\t} else {\n\t\t\there.val(1);\n\t\t}\n\t}\n\n\tif(here.val() == 0)\n\t{\n\t\there.val(1);\n\t}\n\n\tif(here.parent('td').hasClass('js-order--update-price'))\n\t{\n\t\tvar price = Number(here.val());\n\t\tvar quantity = parents.find('.js-order--update-quantity').text();\n\t}\n\n\tif(here.parent('td').hasClass('js-order--update-quantity'))\n\t{\n\t\tvar price = parents.find('.js-order--update-price').text();\n\t\tvar quantity = Number(here.val());\n\t}\n\n\tvar sum = OrderItemUpdate(item, price, quantity);\n\tparents.find('.js-order--sum').html(sum);\n\there.parent('td').html(here.val());\n\tlocalStorage.setItem('order-table', $('.order-table').html());\n}\n\n// get sum && sum_discount\nfunction OrderTotalPrice(){\n\tvar json = JSON.parse(localStorage.getItem('items'));\n\tvar sum = json.items.reduce(function(sum, current) {\n\t  return sum + current.sum;\n\t}, 0);\n\n\t$('#order-sum').html(sum);\n\tjson.sum = sum;\n\tlocalStorage.setItem('items', JSON.stringify(json));\n}\n\n// push item\nfunction OrderItemAdd(data)\n{\n\tvar json, items;\n\tif(localStorage.getItem('items') == null)\n\t{\n\t\tjson = {};\n\t\titems = [];\n\t\tjson.items = items;\n\t\tjson.items.push(data);\n\t\tjson.sum = data.price * data.quantity;\n\t\tlocalStorage.setItem('items', JSON.stringify(json));\n\t} else {\n\t\tjson = JSON.parse(localStorage.getItem('items'));\n\t\tjson.items.push(data);\n\t\tlocalStorage.setItem('items', JSON.stringify(json));\n\t}\n}\n\n// update item\nfunction OrderItemUpdate(item, price, quantity)\n{\n\tvar json = JSON.parse(localStorage.getItem('items'));\n\tvar sum = Number(price * quantity);\n\tjson.items[item].price = price;\n\tjson.items[item].quantity = quantity;\n\tjson.items[item].sum = sum;\n\tlocalStorage.setItem('items', JSON.stringify(json));\n\tOrderTotalPrice();\n\treturn sum\n}\n\n// order items paste\nfunction OrderItemPaste(json)\n{\n\tvar html, item, id, price, quantity, data;\n\n\titem = $('.order-table tbody tr').length;\n\n\tfor(post in json)\n\t{\n\t\thtml += '<tr data-item=\"'+item+'\">';\n\t\thtml += '<td>'+json[post].barcode+'</td>';\n\t\thtml += '<td>'+json[post].name+'</td>';\n\t\thtml += '<td class=\"js-order--update js-order--update-price\">'+json[post].price+'</td>';\n\t\thtml += '<td class=\"js-order--update js-order--update-quantity\">1</td>';\n\t\thtml += '<td class=\"js-order--sum\">'+json[post].price+'</td>';\n\t\thtml += '<td><button type=\"button\" class=\"btn btn-xs btn-danger js-order--remove\"><i class=\"fa fa-remove\"></i></button></td>';\n\t\thtml += '</tr>';\n\n\t\tdata = {\n\t\t\titem\t : item,\n\t\t\tid \t\t : json[post].id,\n\t\t\tprice    : Number(json[post].price),\n\t\t\tquantity : 1,\n\t\t\tsum \t : Number(json[post].price)\n\t\t}\n\n\t\tOrderItemAdd(data);\n\t}\n\n\t$('.order-table table tbody').append(html);\n\tlocalStorage.setItem('order-table', $('.order-table').html());\n\tCashierPageLoad();\n}\n\n// active button\nfunction OrderTypeActive(index) {\n\tvar btn = index.siblings();\n\n\tbtn.each(function(){\n\t  $(this).removeClass('active');\n\t});\n\n\tindex.addClass('active');\n}\n\n// loader start\nfunction LoaderStart()\n{\n\t$('body').append('<div class=\"loader\"></div>');\t\n}\n\n// loader stop\nfunction LoaderStop()\n{\n\t$('.loader').remove();\n}\n\n// answer success\nfunction AnswerSuccess(answer)\n{\n\t$('#alert').removeClass().addClass('alert alert-success').html(answer);\t\n}\n\n// answer error\nfunction AnswerError(answer)\n{\n\t$('#alert').removeClass().addClass('alert alert-danger').html(answer);\t\t\t\n}\n\n// answer info\nfunction AnswerInfo(answer)\n{\n\t$('#alert').removeClass().addClass('alert alert-info').html(answer);\t\n}\n\n// answer warning\nfunction AnswerWarning(answer)\n{\n\t$('#alert').removeClass().addClass('alert alert-warning').html(answer);\t\n}\n\n$(document).ready(function() {\n\n// datepicker\n$(function () {\n\t$('#datetimepicker, #datetimepicker2').datetimepicker(\n\t\t{locale: 'ru', format: 'DD/MM/YYYY'}\n\t);\n});\n\n// date range\n$('#js-settings--date-range').click(function(e){\n\te.preventDefault();\n\n\tvar dateStart, dateEnd, data, url, segments, html, json;\n\n\tdateStart = $('#date_start').val();\n\tdateEnd   = $('#date_end').val();\n\tdata \t  = {'dateStart':dateStart, 'dateEnd':dateEnd};\n\n\t$.ajax({\n\t\turl:     base_url + segment1 + segment2 + 'date',\n\t\ttype:     \"PATCH\",\n\t\tdataType: \"json\",\n\t\tdata: data,\n\n\t\tbeforeSend: function(){\n\t\t\t$('.dropdown').removeClass('open');\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\n\t\t\tif(answer.status == 0)\n\t\t\t{\n\t\t\t\t$('.table').addClass('hidden');\n\t\t\t\t$('.col-footer').addClass('hidden');\n\t\t\t\t$('.col-body').append('<h2>'+answer.data+'</h2>');\n\t\t\t}\n\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\thtml = \"\";\n\t\t\t\tjson = JSON.stringify(answer.data);\n\t\t\t\tdata = JSON.parse(json);\n\n\t\t\t\tfor(row in data)\n\t\t\t\t{\n\t\t\t\t\thtml += '<tr>';\n\t\t\t\t\thtml += '<td class=\"js-order--url\" data-url=\"'+base_url + segment1 + segment2 + data[row].id+'\">'+data[row].id+'</td>';\n\t\t\t\t\thtml += '<td>'+data[row].date+'</td>';\n\t\t\t\t\thtml += '<td>'+data[row].sum+'</td>';\n\t\t\t\t\thtml += '<td>'+data[row].sum_discount+'</td>';\n\t\t\t\t\thtml += '<td>'+data[row].type+'</td>';\n\t\t\t\t\thtml += '</tr>';\n\t\t\t\t}\n\n\t\t\t\t$('.col-body h2').remove();\n\t\t\t\t$('.table').removeClass('hidden');\n\t\t\t\t$('.col-footer').removeClass('hidden');\n\t\t\t\t$('.table tbody').html(html);\n\t\t\t\t$('.totalSum').html('Итого: ' + answer.extra.totalSum + ' &#8381;');\n\t\t\t\t$('.totalSumDiscount').html('Итого со скидкой: ' + answer.extra.totalSumDiscount + ' &#8381;');\n\t\t\t}\n\t    }\n\t}).complete(function() {\n\t    LoaderStop();\n\t});\n});","/*\n\t------- ITEMS FUNCTION ------- \n*/\n\n// update price item\n$('.js-item--update').on('click', function(){\n\tvar here = $(this);\n\tvar data = here.text();\n\tvar type = here.data('type');\n\there.html('<input type=\"text\" data-type=\"'+type+'\" value=\"'+data+'\">');\n\there.attr('id', 'js-item--update');\n\there.find('input').numeric().focus();\n});\n\n// update item\n$(document).on('focusout', 'td#js-item--update input', function(){\n\tvar here = $(this);\n\tvar id = here.parents('tr').attr('item');\n\tvar value = here.val();\n\tvar type = here.data('type');\n\n\tvar data = {};\n\tdata[type] = value;\n\n\t$.ajax({\n\t\turl:     'items/' + id,\n\t\ttype:     \"PATCH\",\n\t\tdataType: \"json\",\n\t\tdata: data,\n\n\t\tbeforeSend: function(){\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\n\t\t\tif(answer.status == 0)\n\t\t\t{\n\t\t\t\tAnswerError(answer.message);\n\t\t\t}\n\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\there.parent('td').removeAttr('id').html(value);\n\t\t\t\tAnswerSuccess(answer.message);\n\t\t\t}\n\n\t    }\n\t}).complete(function() {\n\t    LoaderStop();\n\t});\n});\n\n// update status\n$('body').on('click', '.js-item--status', function(e){\n\te.preventDefault();\n\tvar btn = $(this);\n\tvar status = btn.attr('data-status');\n\tvar id = btn.attr('data-id');\n\tvar data = {'id':id, 'status':status}\n\n\t$.ajax({\n\t\turl:     'items/status',\n\t\ttype:     \"PATCH\",\n\t\tdataType: \"json\",\n\t\tdata: data,\n\n\t\tbeforeSend: function(){\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\n\t\t\tif(answer.status == 0)\n\t\t\t{\n\t\t\t\tbtn.removeClass('btn-success').addClass('btn-danger');\n\t\t\t\tbtn.html('<i class=\"fa fa-ban\"></i>');\n\t\t\t\tbtn.attr('data-status', answer.status);\n\t\t\t}\n\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\tbtn.removeClass('btn-danger').addClass('btn-success');\n\t\t\t\tbtn.html('<i class=\"fa fa-check\"></i>');\n\t\t\t\tbtn.attr('data-status', answer.status);\n\t\t\t}\n\n\t    }\n\t}).complete(function() {\n\t    LoaderStop();\n\t});\n});\n\n// search item\n$('#js-item--barcode').focusout(function() {\n\tvar barcode = $(this).val();\n\tvar data = {'barcode':barcode}\n\n\tif(barcode)\n\t{\n\t\t$.ajax({\n\t\t\turl:     base_url + segment1 + 'items/search',\n\t\t\ttype:     \"POST\",\n\t\t\tdataType: \"json\",\n\t\t\tdata: data,\n\n\t\t\tbeforeSend: function(){\n\t        \tLoaderStart();\n\t\t    },\n\n\t\t\tsuccess: function(answer) {\n\t\t\t\tif(answer.status == 0)\n\t\t\t\t{\n\t\t\t\t\t$('#item_id, #name, #price, #quantity').val('');\n\t\t\t\t\t$('#js-item--sbm').text('Создать');\n\t\t\t\t\tAnswerInfo('<strong>'+answer.message+'</strong>. Будет создан новый');\n\t\t\t\t}\n\n\t\t\t\tif(answer.status == 1)\n\t\t\t\t{\n\t\t\t\t\tvar json = JSON.stringify(answer.items);\n\t\t\t\t\tvar item = JSON.parse(json);\n\n\t\t\t\t\t$('#item_id').val(item.id);\n\t\t\t\t\t$('#name').val(item.name);\n\t\t\t\t\t$('#price').val(item.price);\n\t\t\t\t\t$('#quantity').val(item.quantity);\n\t\t\t\t\t$('#js-item--sbm').text('Обновить');\n\t\t\t\t\tAnswerWarning('<strong>'+answer.message+'</strong>. Будет обновлен');\n\t\t\t\t}\n\t\t    }\n\n\t\t}).complete(function() {\n\t        LoaderStop();\n\t\t});\n\t}\n});\n\n// create & update item\n$('body').on('click', '#js-item--sbm', function(e){\n\te.preventDefault();\n\tvar data = $('#form_item').serialize();\n\tvar id = $('#item_id').val();\n\n\tif(id == 0)\n\t{\n\t\t//create\n\t\turl = base_url + segment1 + segment2;\n\t\ttype = \"POST\";\n\n\t} else {\n\t\t//update\n\t\turl = id;\n\t\ttype = \"PATCH\";\n\t}\n\n\t$.ajax({\n\t\turl:      url,\n\t\ttype:     type,\n\t\tdataType: \"json\",\n\t\tdata: \t  data,\n\n\t\tbeforeSend: function(){\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\n\t\t\tif(answer.status == 0)\n\t\t\t{\n\t\t\t\tAnswerError('<strong>'+answer.message+'</strong>');\n\t\t\t}\n\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\tAnswerInfo('<strong>'+answer.message+'</strong>');\n\t\t\t}\n\n\t    },\n\n\t    error: function(answer) {\n\t    \tAnswerError('<strong>Ошибка!</strong> Заполните поля');\n\t    }\n\n\t}).complete(function() {\n\t        LoaderStop();\n\t\t});\n\n});\n\n// select barcode\n$('body').on('click', '.js-item--print-review', function(e){\n\te.preventDefault();\n\tvar barcode = $(this).data('barcode');\n\t$('#print-modal strong').html(barcode);\n\t$('#js-item--print-review').val(barcode);\n\t$('#print-modal').modal('show');\n});\n\n// open modal barcode review\n$('#print-modal').on('shown.bs.modal', function () {\n    $('#print-quantity').numeric({decimal: false, negative: false}).focus();\n});\n\n// if qty = 0 return 1\n$('#print-quantity').keyup(function(){\n\tif($(this).val() == '0'){\n\t\t$(this).val(1);\n\t}\n});\n\n// close modal & clear review\n$('#js-item--print-cancel').click(function(e){\n\t$('.full').addClass('hidden');\n\t$('.row').removeClass('hidden');\n\t$('#print-modal').modal('hide');\n});\n\n// generate barcode\n$('#js-item--print-review').click(function(e){\n\t$('#print-modal').modal('hide');\n\t$('.row').addClass('hidden');\n\tvar html = \"\";\n\tvar barcode = $('#js-item--print-review').val();\n\tvar quantity = $('#print-quantity').val();\n\tvar data = {'barcode':barcode};\n\n\t$.ajax({\n\t\turl \t : base_url + 'admin/items/barcode/generate',\n\t\ttype \t : 'POST',\n\t\tdataType : 'json',\n\t\tdata \t : data,\n\n\t\tbeforeSend: function(){\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\tvar json = JSON.stringify(answer.item);\n\t\t\t\tvar item = JSON.parse(json);\n\t\t\t\tfor (i = 0; i < quantity; i++) {\n\t\t\t\t\thtml += '<div class=\"box\">';\n\t\t\t\t\thtml += '<div class=\"header\">ИП Зибарева С.С.</div>';\n\t\t\t\t\thtml += '<div class=\"description\"><span>'+item.barcode+'</span><time>'+answer.time+'</time></div>';\n\t\t\t\t\thtml += '<div class=\"title\">'+item.name+'</div>';\n\t\t\t\t\thtml += '<div class=\"barcode\">'+answer.barcode+'<br>';\n\t\t\t\t\thtml += '<span>'+item.barcode+'</span></div>';\n\t\t\t\t\thtml += '<div class=\"footer\"><p>'+item.price+'</p>';\n\t\t\t\t\thtml += '<span>руб. за шт.</span>';\n\t\t\t\t\thtml += '</div></div>';\n\t\t\t\t}\n\n\t\t\t\t$('.full').removeClass('hidden');\n\t\t\t\t$('.print').html(html);\n\t\t\t}\n\t    },\n\n\t    error: function(answer) {\n\t    \tAnswerError('Укажите тип оплаты');\n\t\t}\n\n\t}).complete(function() {\n\t        LoaderStop();\n\t\t});\n});\n\n// print\n$('body').on('click', '#js-print', function(e){\n\te.preventDefault();\n\twindow.print();\n});\n\n/*\n\t------- CASHIER FUNCTION ------- \n*/\n\n// type order\n$('body').on('click', '.js-order--type', function(e){\n\tvar btn = $(this);\n\tvar type = Number(btn.val());\n\n\tif(localStorage){\n\t\tlocalStorage['order-type-index'] = $(this).index();\n\t}\n\n\tvar json = JSON.parse(localStorage.getItem('items'));\n\tjson.type = type;\n\tlocalStorage.setItem('items', JSON.stringify(json));\n\tOrderTypeActive(btn);\n});\n\n// search item\n$('#js-item--search').keyup(function(e){\n\te.preventDefault();\n\tvar barcode = $(this).val();\n\tvar data = {'barcode':barcode}\n\n\tif(barcode.length > 10)\n\t{\n\t\t$.ajax({\n\t\t\turl:      base_url + segment1 + 'items/search',\n\t\t\ttype:     'POST',\n\t\t\tdataType: 'json',\n\t\t\tdata:     data,\n\n\t\t\tbeforeSend: function(){\n\t\t        LoaderStart();\n\t\t    },\n\n\t\t\tsuccess: function(answer) {\n\t\t\t\tif(answer.status == 0)\n\t\t\t\t{\n\t\t\t\t\tAnswerError('<button id=\"js-item--barcode-create\" class=\"btn btn-danger\">Отправить штрихкод</button>');\n\t\t\t\t}\n\n\t\t\t\tif(answer.status == 1)\n\t\t\t\t{\n\t\t\t\t\t$('.order').removeClass('hidden');\n\t\t\t\t\t$('#alert').removeClass().html('');\n\t\t\t\t\tvar data = JSON.stringify(answer.items);\n\t\t\t\t\tvar json = JSON.parse(data);\n\t\t\t\t\tOrderItemPaste(json);\n\t\t\t\t\tconsole.log(json);\n\t\t\t\t}\n\t\t    },\n\n\t\t    error: function(answer) {\n\t\t    \tAnswerError('Введите штрихкод');\n\t\t    }\n\n\t\t}).complete(function() {\n\t\t\t\tLoaderStop();\n\t\t\t});\n\t}\n});\n\n// select update item order\n$(document).on('click', '.js-order--update', function(){\n\tvar here = $(this);\n\tvar data = here.text();\n\there.html('<input type=\"text\" id=\"js-order--update\" placeholder=\"'+data+'\">');\n\t$(\"#js-order--update\").numeric();\n\there.find('input').focus();\n});\n\n// update item press enter\n$(document).on('keypress', '#js-order--update', function(e){\n\tif(e.which == 13) {\n\t\tOrderUpdate($(this));\n\t}\n});\n\n// update item focusout\n$(document).on('focusout', '#js-order--update', function(){\n\tOrderUpdate($(this));\n});\n\n// delete item order\n$('body').on(\"click\", \".js-order--remove\", function(){\n\tvar parents  = $(this).parents('tr');\n\tvar item  \t = parents.data('item');\n\tvar price \t = parents.find('.js-order--price').val();\n\tvar quantity = parents.find('.js-order--quantity').val();\n\tvar count \t = $('.order-table tbody tr').length;\n\tvar json \t = JSON.parse(localStorage.getItem('items'));\n\n\tvar index = json.items.findIndex(function(array, i){\n\t   \treturn array.item === item\n\t});\n\n\tjson.items.splice(index, 1);\n\tlocalStorage.setItem('items', JSON.stringify(json));\n\n\tparents.remove();\n\n\tif(count == 1)\n\t{\n\t\tOrderClear();\n\t} else {\n\t\tlocalStorage.setItem('order-table', $('.order-table').html());\n\t\tOrderTotalPrice();\n\t}\n});\n\n// create new item (cashier -> admin)\n$('body').on('click', '#js-item--barcode-create', function(e){\n\te.preventDefault();\n\n\tvar barcode = $('#item-search').val();\n\tvar data = {'barcode':barcode}\n\n\t$.ajax({\n\t\turl:     'cashier/barcode',\n\t\ttype:     \"POST\",\n\t\tdataType: \"json\",\n\t\tdata: data,\n\n\t\tbeforeSend: function(){\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\n\t\t\tif(answer.status == 0)\n\t\t\t{\n\t\t\t\tAnswerError(answer.message);\n\t\t\t}\n\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\tAnswerSuccess(answer.message);\n\t\t\t}\n\n\t    },\n\n\t    error: function(answer) {\n\t    \tAnswerSuccess('Ошибка');\n\t    }\n\n\t}).complete(function() {\n\t        LoaderStop();\n\t\t});\n});","/*\n\t------- ORDERS FUNCTION ------- \n*/\n\n// order url\n$('body').on('click', '.js-order--url', function(e){\n\te.preventDefault();\n\tvar url = $(this).data('url');\n    window.location = url;\n});\n\n// create order and supply\n$('body').on('click', '#js-order-and-supply--create', function(e){\n\te.preventDefault();\n\n\tvar json, sum, sumDiscount, type, items, data;\n\n\tjson  = JSON.parse(localStorage.getItem('items'));\n\tsum   = json.sum;\n\ttype  = json.type;\n\titems = JSON.stringify(json.items);\n\tdata  = {'sum':sum, 'type':type, 'items':items};\n\n\turl = segment2.substring(0, segment2.length - 1)\n\n\tif(url != 'supply')\n\t{\n\t\turl = 'orders';\n\t}\n\n\t$.ajax({\n\t\turl \t : base_url + segment1 + url,\n\t\ttype \t : 'POST',\n\t\tdataType : 'json',\n\t\tdata  \t : data,\n\n\t\tbeforeSend: function(){\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\tOrderClear();\n\t\t\t\tAnswerSuccess(answer.message);\n\t\t\t}\n\t    },\n\n\t    error: function(answer) {\n\t    \tAnswerError('Укажите тип оплаты');\n\t\t}\n\n\t}).complete(function() {\n\t        LoaderStop();\n\t\t});\n});","/*\n\t------- SUPPLY FUNCTION ------- \n*/","/*\n\t------- COSTS FUNCTION ------- \n*/\n\n// create costs\n$('body').on('click', '#js-costs--create', function(e){\n\te.preventDefault();\n\n\tvar data = $('#form_costs').serialize();\n\n\t$.ajax({\n\t\turl:      base_url + 'costs',\n\t\ttype:     'POST',\n\t\tdataType: 'json',\n\t\tdata: \t  data,\n\n\t\tbeforeSend: function(){\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\tAnswerSuccess(answer.message);\n\t\t\t}\n\t    },\n\n\t    error: function(answer) {\n\t    \tAnswerError('Заполните все поля');\n\t\t}\n\t})\n\t.complete(function() {\n\t    LoaderStop();\n\t\t$('#price').val('');\n\t});\n});","/*\n\t------- SETTINGS FUNCTION ------- \n*/\n\n// csrf token add to post request\n$.ajaxSetup({\n\theaders: {\n\t  'X-CSRF-Token': $('meta[name=\"_token\"]').attr('content')\n\t}\n});\n\n});"],"sourceRoot":"/source/"}