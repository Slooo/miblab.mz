{"version":3,"sources":["main.js","items.js","orders.js","supply.js","costs.js","settings.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnaA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACxZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5CA;AACA;AACA;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"app.js","sourcesContent":["/*\n\t------- MAIN FUNCTION ------- \n*/\n\n// cashier\nvar CashierPageLoad = function CashierPageLoad()\n{\n\tif(localStorage.getItem('order-table') == null)\n\t{\n\t\t$('.order').addClass('hidden');\n\t\t$('#js-item--search').val('').focus();\n\t} else {\n\t\tOrderTotalPrice();\n\t\tOrderTypeActive($('.js-order--type').eq(localStorage['order-type-index']));\n\t\t$('.order-table').removeClass('hidden').html(localStorage.getItem('order-table'));\n\t}\n}\n\n// clear order\nfunction OrderClear()\n{\n\tlocalStorage.clear();\n\t$('.order-table table tbody').html('');\n\t$('.js-order--type').removeClass('active');\n\tCashierPageLoad();\n}\n\n// update order\nfunction OrderUpdate(here)\n{\n\tvar parents, item, placeholder, price, quantity, sum;\n\n\tparents \t= here.parents('tr');\n\titem \t \t= parents.data('item');\n\tplaceholder = here.attr('placeholder');\n\n\tif(here.val().length == 0)\n\t{\n\t\tif(placeholder.length > 0)\n\t\t{\n\t\t\there.val(placeholder);\n\t\t} else {\n\t\t\there.val(1);\n\t\t}\n\t}\n\n\tif(here.val() == 0)\n\t{\n\t\there.val(1);\n\t}\n\n\tif(here.parent('td').hasClass('js-order--update-price'))\n\t{\n\t\tprice = Number(here.val());\n\t\tquantity = parents.find('.js-order--update-quantity').text();\n\t}\n\n\tif(here.parent('td').hasClass('js-order--update-quantity'))\n\t{\n\t\tprice = parents.find('.js-order--update-price').text();\n\t\tquantity = Number(here.val());\n\t}\n\n\tsum = OrderItemUpdate(item, price, quantity);\n\tparents.find('.js-order--sum').html(sum);\n\there.parent('td').html(here.val());\n\tlocalStorage.setItem('order-table', $('.order-table').html());\n}\n\n// get sum && sum_discount\nfunction OrderTotalPrice(){\n\tvar json, sum;\n\t\n\tjson = JSON.parse(localStorage.getItem('items'));\n\tsum = json.items.reduce(function(sum, current) {\n\t  return sum + current.sum;\n\t}, 0);\n\n\t$('#order-sum').html(sum);\n\tjson.sum = sum;\n\tlocalStorage.setItem('items', JSON.stringify(json));\n}\n\n// push item\nfunction OrderItemAdd(data)\n{\n\tvar json, items;\n\tif(localStorage.getItem('items') == null)\n\t{\n\t\tjson = {};\n\t\titems = [];\n\t\tjson.items = items;\n\t\tjson.items.push(data);\n\t\tjson.sum = data.price * data.quantity;\n\t\tlocalStorage.setItem('items', JSON.stringify(json));\n\t} else {\n\t\tjson = JSON.parse(localStorage.getItem('items'));\n\t\tjson.items.push(data);\n\t\tlocalStorage.setItem('items', JSON.stringify(json));\n\t}\n}\n\n// update item\nfunction OrderItemUpdate(item, price, quantity)\n{\n\tvar json, sum;\n\n\tjson = JSON.parse(localStorage.getItem('items'));\n\tsum  = Number(price * quantity);\n\n\tjson.items[item].price = price;\n\tjson.items[item].quantity = quantity;\n\tjson.items[item].sum = sum;\n\tlocalStorage.setItem('items', JSON.stringify(json));\n\tOrderTotalPrice();\n\treturn sum\n}\n\n// order items paste\nfunction OrderItemPaste(json)\n{\n\tvar html, item, id, price, quantity, data;\n\n\titem = $('.order-table tbody tr').length;\n\n\tfor(post in json)\n\t{\n\t\thtml += '<tr data-item=\"'+item+'\">';\n\t\thtml += '<td>'+json[post].barcode+'</td>';\n\t\thtml += '<td>'+json[post].name+'</td>';\n\t\thtml += '<td class=\"js-order--update js-order--update-price\">'+json[post].price+'</td>';\n\t\thtml += '<td class=\"js-order--update js-order--update-quantity\">1</td>';\n\t\thtml += '<td class=\"js-order--sum\">'+json[post].price+'</td>';\n\t\thtml += '<td><button type=\"button\" class=\"btn btn-xs btn-danger js-order--remove\"><i class=\"fa fa-remove\"></i></button></td>';\n\t\thtml += '</tr>';\n\n\t\tdata = {\n\t\t\titem\t : item,\n\t\t\tid \t\t : json[post].id,\n\t\t\tprice    : Number(json[post].price),\n\t\t\tquantity : 1,\n\t\t\tsum \t : Number(json[post].price)\n\t\t}\n\n\t\tOrderItemAdd(data);\n\t}\n\n\t$('.order-table table tbody').append(html);\n\tlocalStorage.setItem('order-table', $('.order-table').html());\n\tCashierPageLoad();\n}\n\n// active button\nfunction OrderTypeActive(index) {\n\tvar btn = index.siblings();\n\n\tbtn.each(function(){\n\t  $(this).removeClass('active');\n\t});\n\n\tindex.addClass('active');\n}\n\n// loader start\nfunction LoaderStart()\n{\n\t$('body').append('<div class=\"loader\"></div>');\t\n}\n\n// loader stop\nfunction LoaderStop()\n{\n\t$('.loader').remove();\n}\n\n// answer success\nfunction AnswerSuccess(answer)\n{\n\t$('#alert').removeClass().addClass('alert alert-success').html('<strong>'+answer+'</strong>');\t\t\n}\n\n// answer error\nfunction AnswerError()\n{\n\t$('#alert').removeClass().addClass('alert alert-danger').html('<strong>Ошибка запроса</strong>');\t\n}\n\n// answer info\nfunction AnswerInfo(answer)\n{\n\t$('#alert').removeClass().addClass('alert alert-info').html('<strong>'+answer+'</strong>');\t\n}\n\n// answer warning\nfunction AnswerWarning(answer)\n{\n\t$('#alert').removeClass().addClass('alert alert-warning').html('<strong>'+answer+'</strong>');\t\n}\n\n$(document).ready(function() {\n\n// datepicker\n$(function () {\n\t$('#datetimepicker, #datetimepicker2').datetimepicker(\n\t\t{locale: 'ru', format: 'DD/MM/YYYY'}\n\t);\n});\n\n// DATE RANGE\n$('#js-settings--date-range').click(function(e){\n\te.preventDefault();\n\n\tvar dateStart, dateEnd, data, url, segments, html, json;\n\n\tdateStart = $('#date_start').val();\n\tdateEnd   = $('#date_end').val();\n\tdata \t  = {'dateStart' : dateStart, 'dateEnd' : dateEnd, 'id' : segment3};\n\n\t$.ajax({\n\t\turl \t : base_url + segment1 + segment2 + 'date',\n\t\ttype \t : \"patch\",\n\t\tdataType : \"json\",\n\t\tdata \t : data,\n\n\t\tbeforeSend: function(){\n\t\t\t$('.dropdown').removeClass('open');\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\n\t\t\t$('.col-body h2').remove();\n\n\t\t\tif(answer.status == 0)\n\t\t\t{\n\t\t\t\t$('.table').addClass('hidden');\n\t\t\t\t$('.col-footer').addClass('hidden');\n\t\t\t\t$('.col-body').append('<h2>'+answer.data+'</h2>');\n\t\t\t}\n\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\thtml = \"\";\n\t\t\t\tjson = JSON.stringify(answer.data);\n\t\t\t\tdata = JSON.parse(json);\n\t\t\t\t\n\t\t\t\t$('.table').removeClass('hidden');\n\t\t\t\t$('.col-footer').removeClass('hidden');\n\n\t\t\t\tif(segment2 != 'costs/')\n\t\t\t\t{\n\t\t\t\t\tfor(row in data)\n\t\t\t\t\t{\n\t\t\t\t\t\thtml += '<tr data-id=\"'+data[row].id+'\" data-type=\"main\">';\n\t\t\t\t\t\thtml += '<td class=\"col-md-2 js-url--link\" data-url=\"'+base_url + segment1 + segment2 + data[row].id+'\">'+data[row].id+'</td>';\n\t\t\t\t\t\thtml += '<td class=\"col-md-1\">'+data[row].date+'</td>';\n\t\t\t\t\t\thtml += '<td class=\"col-md-3\">'+data[row].sum+'</td>';\n\t\t\t\t\t\thtml += '<td class=\"col-md-3\">'+data[row].sum_discount+'</td>';\n\t\t\t\t\t\thtml += '<td class=\"col-md-2\">'+data[row].type+'</td>';\n\t\t\t\t\t\thtml += '<td class=\"col-md-1\"><button class=\"btn btn-circle btn-danger js--delete\"><li class=\"fa fa-remove\"></li></button></td>';\n\t\t\t\t\t\thtml += '</tr>';\n\t\t\t\t\t}\n\n\t\t\t\t} else {\n\t\t\t\t\tfor(row in data)\n\t\t\t\t\t{\n\t\t\t\t\t\thtml += '<tr data-id=\"'+data[row].id+'\" data-type=\"pivot\">';\n\t\t\t\t\t\thtml += '<td class=\"col-md-1\">'+data[row].date+'</td>';\n\t\t\t\t\t\thtml += '<td class=\"col-md-10\">'+data[row].sum+'</td>';\n\t\t\t\t\t\thtml += '<td class=\"col-md-1\"><button class=\"js--delete btn btn-circle btn-danger\"><li class=\"fa fa-remove\"></li></button></td>';\n\t\t\t\t\t\thtml += '</tr>';\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$('.table tbody').html(html);\n\t\t\t\t$('.totalSum').html('Итого: ' + answer.extra.totalSum + ' &#8381;');\n\t\t\t}\n\t    },\n\n\t    error: function(answer) {\n\t    \tAnswerError();\n\t    }\n\n\t}).complete(function() {\n\t    LoaderStop();\n\t});\n});\n\n// link url\n$('body').on('click', '.js-url--link', function(e){\n\te.preventDefault();\n\tvar url = $(this).data('url');\n    window.location = url;\n});\n\n// CHANGE UPDATE => costs | supply | items\n$('.js--update').on('click', function(){\n\tvar here, data, type;\n\n\there = $(this);\n\tdata = here.text().replace(/\\s+/g, '');\n\ttype = here.data('type');\n\n\there.html('<input type=\"text\" data-type=\"'+type+'\" value=\"'+data+'\">');\n\there.attr('id', 'js--update');\n\there.find('input').numeric().focus();\n});\n\n// UPDATE => costs | supply | items\n$(document).on('focusout', 'td#js--update input', function(){\n\tvar here, id, val, col, data;\n\n\there = $(this);\n\tid   = here.parents('tr').data('id');\n\tval  = here.val().replace(/\\s+/g, '');\n\tcol  = here.data('type');\n\n\tdata = {'id' : id, 'col' : col, 'val' : val};\n\n\tsegment3 = (segment3 == '' ? id : segment3);\n\n\tif(val.length > 0) {\n\t\t$.ajax({\n\t\t\turl \t : base_url + segment1 + segment2 + segment3,\n\t\t\ttype \t : \"patch\",\n\t\t\tdataType : \"json\",\n\t\t\tdata \t : data,\n\n\t\t\tbeforeSend: function(){\n\t\t        LoaderStart();\n\t\t    },\n\n\t\t\tsuccess: function(answer) {\n\n\t\t\t\tif(answer.status == 0)\n\t\t\t\t{\n\t\t\t\t\tAnswerError();\n\t\t\t\t}\n\n\t\t\t\tif(answer.status == 1)\n\t\t\t\t{\n\t\t\t\t\tif($('strong').hasClass('totalSum') || $('strong').hasClass('totalSumDiscount'))\n\t\t\t\t\t{\n\t\t\t\t\t\t$('.totalSumDiscount').html('Итого со скидкой: ' + answer.data.totalSumDiscount + ' &#8381;');\n\t\t\t\t\t\t$('.totalSum').html('Итого: ' + answer.data.totalSum + ' &#8381;');\t\t\t\t\t\t\n\t\t\t\t\t}\n\n\t\t\t\t\there.parents('tr').find('.sum').text(answer.data.sum);\n\t\t\t\t\there.parent('td').removeAttr('id').text(answer.data.value);\n\n\t\t\t\t\tAnswerSuccess(answer.message);\n\t\t\t\t}\n\n\t\t    },\n\n\t\t    error: function(answer) {\n\t\t    \tAnswerError();\n\t\t    }\n\n\t\t}).complete(function() {\n\t\t    LoaderStop();\n\t\t});\n\t}\n});\n\n// DELETE => costs | orders | supply | items\n$('body').on('click', '.js--delete', function(e){\n\te.preventDefault();\n\n\tvar here, id, type, data;\n\n\there = $(this);\n\tid   = here.parents('tr').data('id');\n\ttype = here.parents('tr').data('type');\n\tdata = {'id' : id, 'type' : type};\n\n\tsegment3 = (segment3 == '' ? id : segment3);\n\n\t$.ajax({\n\t\turl \t : base_url + segment1 + segment2 + segment3,\n\t\ttype \t : 'delete',\n\t\tdataType : 'json',\n\t\tdata \t : data,\n\n\t\tbeforeSend: function(){\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\t\t\tif(answer.status == 0)\n\t\t\t{\n\t\t\t\tAnswerError();\n\t\t\t}\n\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\there.parents('tr').remove();\n\t\t\t\tif($('strong').hasClass('totalSumDiscount') || $('strong').hasClass('totalSum'))\n\t\t\t\t{\n\t\t\t\t\t$('.totalSum').html('Итого: ' + answer.data.totalSum + ' &#8381;');\n\t\t\t\t\t$('.totalSumDiscount').html('Итого со скидкой: ' + answer.data.totalSumDiscount + ' &#8381;');\t\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\tAnswerInfo(answer.message);\n\t\t\t}\n\n\t\t\tif(answer.status == 'redirect')\n\t\t\t{\n\t\t\t\twindow.location.href = base_url + segment1 + segment2;\n\t\t\t}\n\t    },\n\n\t    error: function(answer) {\n\t    \tAnswerError();\n\t    }\n\n\t}).complete(function() {\n\t\t\tLoaderStop();\n\t\t});\n});","/*\n\t------- ITEMS FUNCTION ------- \n*/\n\n// update status\n$('body').on('click', '.js-item--status', function(e){\n\te.preventDefault();\n\n\tvar btn, status, id, data;\n\n\tbtn    = $(this);\n\tstatus = btn.attr('data-status');\n\tid \t   = btn.attr('data-id');\n\tdata   = {'id':id, 'status':status}\n\n\t$.ajax({\n\t\turl \t : base_url + segment1 + segment2 + 'status',\n\t\ttype \t : \"patch\",\n\t\tdataType : \"json\",\n\t\tdata \t : data,\n\n\t\tbeforeSend: function(){\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\t\t\tif(answer.status == 0)\n\t\t\t{\n\t\t\t\tbtn.removeClass('btn-success').addClass('btn-danger');\n\t\t\t\tbtn.html('<i class=\"fa fa-ban\"></i>');\n\t\t\t\tbtn.attr('data-status', answer.status);\n\t\t\t}\n\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\tbtn.removeClass('btn-danger').addClass('btn-success');\n\t\t\t\tbtn.html('<i class=\"fa fa-check\"></i>');\n\t\t\t\tbtn.attr('data-status', answer.status);\n\t\t\t}\n\t    },\n\n\t    error: function(answer) {\n\t    \tAnswerError();\n\t    }\n\n\t}).complete(function() {\n\t    LoaderStop();\n\t});\n});\n\n// search item\n$('#js-item--barcode').focusout(function() {\n\n\tvar barcode, data, json, item;\n\n\tbarcode = $(this).val();\n\tdata = {'barcode':barcode}\n\n\tif(barcode)\n\t{\n\t\t$.ajax({\n\t\t\turl:     base_url + segment1 + segment2 + 'search',\n\t\t\ttype:     \"patch\",\n\t\t\tdataType: \"json\",\n\t\t\tdata: data,\n\n\t\t\tbeforeSend: function(){\n\t        \tLoaderStart();\n\t\t    },\n\n\t\t\tsuccess: function(answer) {\n\t\t\t\tif(answer.status == 0)\n\t\t\t\t{\n\t\t\t\t\t$('#item_id, #name, #price, #quantity').val('');\n\t\t\t\t\t$('#js-item--sbm').text('Создать');\n\t\t\t\t\tAnswerInfo('<strong>'+answer.message+'</strong>. Будет создан новый');\n\t\t\t\t}\n\n\t\t\t\tif(answer.status == 1)\n\t\t\t\t{\n\t\t\t\t\tjson = JSON.stringify(answer.items);\n\t\t\t\t\titem = JSON.parse(json);\n\n\t\t\t\t\t$('#item_id').val(item.id);\n\t\t\t\t\t$('#name').val(item.name);\n\t\t\t\t\t$('#price').val(item.price);\n\t\t\t\t\t$('#quantity').val(item.quantity);\n\t\t\t\t\t$('#js-item--sbm').text('Обновить');\n\t\t\t\t\tAnswerWarning('<strong>'+answer.message+'</strong>. Будет обновлен');\n\t\t\t\t}\n\t\t    },\n\n\t\t    error: function(answer) {\n\t\t    \tAnswerError();\n\t\t    }\n\n\t\t}).complete(function() {\n\t        LoaderStop();\n\t\t});\n\t}\n});\n\n// create & update item\n$('body').on('click', '#js-item--sbm', function(e){\n\te.preventDefault();\n\n\tvar data, id, url, type;\n\t\n\tdata = $('#form_item').serialize();\n\tid \t = $('#item_id').val();\n\n\tif(id == 0)\n\t{\n\t\t//create\n\t\turl = base_url + segment1 + segment2;\n\t\ttype = \"post\";\n\n\t} else {\n\t\t//update\n\t\turl = id;\n\t\ttype = \"patch\";\n\t}\n\n\t$.ajax({\n\t\turl \t : url,\n\t\ttype \t : type,\n\t\tdataType : \"json\",\n\t\tdata \t : data,\n\n\t\tbeforeSend: function(){\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\n\t\t\tif(answer.status == 0)\n\t\t\t{\n\t\t\t\tAnswerError(answer.message);\n\t\t\t}\n\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\tAnswerInfo(answer.message);\n\t\t\t}\n\n\t    },\n\n\t    error: function(answer) {\n\t    \tAnswerError();\n\t    }\n\n\t}).complete(function() {\n\t        LoaderStop();\n\t\t});\n\n});\n\n// select barcode\n$('body').on('click', '.js-item--print-review', function(e){\n\te.preventDefault();\n\tvar barcode = $(this).data('barcode');\n\t$('#print-modal strong').html(barcode);\n\t$('#js-item--print-review').val(barcode);\n\t$('#print-modal').modal('show');\n});\n\n// open modal barcode review\n$('#print-modal').on('shown.bs.modal', function () {\n    $('#print-quantity').numeric({decimal: false, negative: false}).focus();\n});\n\n// if qty = 0 return 1 вставить везде\n$('#print-quantity').keyup(function(){\n\tif($(this).val() == '0'){\n\t\t$(this).val(1);\n\t}\n});\n\n// close modal & clear review\n$('#js-item--print-cancel').click(function(e){\n\t$('.full').addClass('hidden');\n\t$('.row').removeClass('hidden');\n\t$('#print-modal').modal('hide');\n});\n\n// generate barcode\n$('#js-item--print-review').click(function(e){\n\n\t$('#print-modal').modal('hide');\n\t$('.row').addClass('hidden');\n\n\tvar html, barcode, quantity, data, json, item;\n\n\thtml \t = \"\";\n\tbarcode  = $('#js-item--print-review').val();\n\tquantity = $('#print-quantity').val();\n\tdata \t = {'barcode':barcode};\n\n\t$.ajax({\n\t\turl \t : base_url + segment1 + segment2 + 'barcode/generate',\n\t\ttype \t : 'patch',\n\t\tdataType : 'json',\n\t\tdata \t : data,\n\n\t\tbeforeSend: function(){\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\tjson = JSON.stringify(answer.item);\n\t\t\t\titem = JSON.parse(json);\n\t\t\t\tfor (i = 0; i < quantity; i++) {\n\t\t\t\t\thtml += '<div class=\"box\">';\n\t\t\t\t\thtml += '<div class=\"header\">ИП Зибарева С.С.</div>';\n\t\t\t\t\thtml += '<div class=\"description\"><span>'+item.barcode+'</span><time>'+answer.time+'</time></div>';\n\t\t\t\t\thtml += '<div class=\"title\">'+item.name+'</div>';\n\t\t\t\t\thtml += '<div class=\"barcode\">'+answer.barcode+'<br>';\n\t\t\t\t\thtml += '<span>'+item.barcode+'</span></div>';\n\t\t\t\t\thtml += '<div class=\"footer\"><p>'+item.price+'</p>';\n\t\t\t\t\thtml += '<span>руб. за шт.</span>';\n\t\t\t\t\thtml += '</div></div>';\n\t\t\t\t}\n\n\t\t\t\t$('.full').removeClass('hidden');\n\t\t\t\t$('.print').html(html);\n\t\t\t}\n\t    },\n\n\t    error: function(answer) {\n\t    \tAnswerError();\n\t\t}\n\n\t}).complete(function() {\n\t        LoaderStop();\n\t\t});\n});\n\n// print\n$('body').on('click', '#js-print', function(e){\n\te.preventDefault();\n\twindow.print();\n});\n\n/*\n\t------- CASHIER FUNCTION ------- \n*/\n\n// type order\n$('body').on('click', '.js-order--type', function(e){\n\t\n\tvar btn, type, json;\n\n\tbtn  = $(this);\n\ttype = Number(btn.val());\n\n\tif(localStorage){\n\t\tlocalStorage['order-type-index'] = $(this).index();\n\t}\n\n\tjson = JSON.parse(localStorage.getItem('items'));\n\tjson.type = type;\n\tlocalStorage.setItem('items', JSON.stringify(json));\n\tOrderTypeActive(btn);\n});\n\n// search item\n$('#js-item--search').keyup(function(e){\n\te.preventDefault();\n\n\tvar barcode, data, json;\n\n\tbarcode = $(this).val();\n\tdata \t= {'barcode':barcode}\n\n\tif(barcode.length > 10)\n\t{\n\t\t$.ajax({\n\t\t\turl \t : base_url + segment1 + 'items/search',\n\t\t\ttype \t : 'patch',\n\t\t\tdataType : 'json',\n\t\t\tdata \t : data,\n\n\t\t\tbeforeSend: function(){\n\t\t        LoaderStart();\n\t\t    },\n\n\t\t\tsuccess: function(answer) {\n\t\t\t\tif(answer.status == 0)\n\t\t\t\t{\n\t\t\t\t\tAnswerWarning('<button id=\"js-item--barcode-create\" class=\"btn btn-danger\">Отправить штрихкод</button>');\n\t\t\t\t}\n\n\t\t\t\tif(answer.status == 1)\n\t\t\t\t{\n\t\t\t\t\t$('.order').removeClass('hidden');\n\t\t\t\t\t$('#alert').removeClass().html('');\n\t\t\t\t\tdata = JSON.stringify(answer.items);\n\t\t\t\t\tjson = JSON.parse(data);\n\t\t\t\t\tOrderItemPaste(json);\n\t\t\t\t}\n\t\t    },\n\n\t\t    error: function(answer) {\n\t\t    \tAnswerError();\n\t\t    }\n\n\t\t}).complete(function() {\n\t\t\t\tLoaderStop();\n\t\t\t});\n\t}\n});\n\n// select update item order\n$(document).on('click', '.js-order--update', function(){\n\tvar here, data;\n\t\n\there = $(this);\n\tdata = here.text();\n\n\there.html('<input type=\"text\" id=\"js-order--update\" placeholder=\"'+data+'\">');\n\t$(\"#js-order--update\").numeric();\n\there.find('input').focus();\n});\n\n// update item press enter\n$(document).on('keypress', '#js-order--update', function(e){\n\tif(e.which == 13) {\n\t\tOrderUpdate($(this));\n\t}\n});\n\n// update item focusout\n$(document).on('focusout', '#js-order--update', function(){\n\tOrderUpdate($(this));\n});\n\n// delete item order\n$('body').on(\"click\", \".js-order--remove\", function(){\n\n\tvar parents, item, price, quantity, count, json, index;\n\n\tparents  = $(this).parents('tr');\n\titem  \t = parents.data('item');\n\tprice \t = parents.find('.js-order--price').val();\n\tquantity = parents.find('.js-order--quantity').val();\n\tcount \t = $('.order-table tbody tr').length;\n\tjson \t = JSON.parse(localStorage.getItem('items'));\n\n\tindex = json.items.findIndex(function(array, i){\n\t   \treturn array.item === item\n\t});\n\n\tjson.items.splice(index, 1);\n\tlocalStorage.setItem('items', JSON.stringify(json));\n\n\tparents.remove();\n\n\tif(count == 1)\n\t{\n\t\tOrderClear();\n\t} else {\n\t\tlocalStorage.setItem('order-table', $('.order-table').html());\n\t\tOrderTotalPrice();\n\t}\n});\n\n// create new item (cashier -> admin)\n$('body').on('click', '#js-item--barcode-create', function(e){\n\te.preventDefault();\n\n\tvar barcode, data;\n\t\n\tbarcode = $('#js--item-search').val();\n\tdata  \t= {'barcode':barcode}\n\n\t$.ajax({\n\t\turl \t : base_url + segment1 + 'items/barcode',\n\t\ttype \t : 'post',\n\t\tdataType : 'json',\n\t\tdata \t : data,\n\n\t\tbeforeSend: function(){\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\n\t\t\tif(answer.status == 0)\n\t\t\t{\n\t\t\t\tAnswerError(answer.message);\n\t\t\t}\n\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\tAnswerSuccess(answer.message);\n\t\t\t}\n\n\t    },\n\n\t    error: function(answer) {\n\t    \tAnswerError();\n\t    }\n\n\t}).complete(function() {\n\t        LoaderStop();\n\t\t});\n});","/*\n\t------- ORDERS FUNCTION ------- \n*/\n\n// create order and supply\n$('body').on('click', '#js-order-and-supply--create', function(e){\n\te.preventDefault();\n\n\tvar json, sum, sumDiscount, type, items, data;\n\n\tjson  = JSON.parse(localStorage.getItem('items'));\n\tsum   = json.sum;\n\ttype  = json.type;\n\titems = JSON.stringify(json.items);\n\tdata  = {'sum' : sum, 'type' : type, 'items' : items};\n\turl   = segment2.substring(0, segment2.length - 1)\n\t\n\turl = (url != 'supply' ? 'orders' : 'supply');\n\n\t$.ajax({\n\t\turl \t : base_url + segment1 + url,\n\t\ttype \t : 'post',\n\t\tdataType : 'json',\n\t\tdata  \t : data,\n\n\t\tbeforeSend: function(){\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\tOrderClear();\n\t\t\t\tAnswerSuccess('<a href=\"'+base_url + segment1 + url + '/' + answer.message +'\">Создано</a>');\n\t\t\t}\n\t    },\n\n\t    error: function(answer) {\n\t    \tAnswerError();\n\t\t}\n\n\t}).complete(function() {\n\t        LoaderStop();\n\t\t});\n});","/*\n\t------- SUPPLY FUNCTION ------- \n*/","/*\n\t------- COSTS FUNCTION ------- \n*/\n\n// create costs\n$('body').on('click', '#js-costs--create', function(e){\n\te.preventDefault();\n\n\tvar data = $('#form_costs').serialize();\n\n\t$.ajax({\n\t\turl \t : base_url + segment1 + segment2.substring(0, segment2.length - 1),\n\t\ttype \t : 'post',\n\t\tdataType : 'json',\n\t\tdata \t : data,\n\n\t\tbeforeSend: function(){\n\t        LoaderStart();\n\t    },\n\n\t\tsuccess: function(answer) {\n\t\t\tif(answer.status == 1)\n\t\t\t{\n\t\t\t\tAnswerSuccess('<a href=\"'+base_url + segment1 + segment2 + answer.message+'\">Расходы внесены</a>');\n\t\t\t}\n\t    },\n\n\t    error: function(answer) {\n\t    \tAnswerError();\n\t\t}\n\t})\n\t.complete(function() {\n\t    LoaderStop();\n\t\t$('#price').val('');\n\t});\n});","/*\n\t------- SETTINGS FUNCTION ------- \n*/\n\n// csrf token add to post request\n$.ajaxSetup({\n\theaders: {\n\t  'X-CSRF-Token': $('meta[name=\"_token\"]').attr('content')\n\t}\n});\n\n});"],"sourceRoot":"/source/"}